<ShowPlanXML xmlns="http://schemas.microsoft.com/sqlserver/2004/07/showplan" Version="1.564" Build="16.0.4085.2"><BatchSequence><Batch><Statements><StmtCond StatementText="/*&#xd;&#xa;Index on City column in Users.DeliveryAddress table&#xd;&#xa;*/&#xd;&#xa;IF EXISTS (SELECT * FROM sys.indexes WHERE name = &apos;idx_City&apos; AND object_id = OBJECT_ID(&apos;Users.DeliveryAddress&apos;))" StatementId="1" StatementCompId="1" StatementType="COND WITH QUERY" StatementSqlHandle="0x0900B3F808023C61E9AEF476D0884F796E7F0000000000000000000000000000000000000000000000000000" DatabaseContextSettingsId="1" ParentObjectId="0" StatementParameterizationType="0" RetrievedFromCache="true" StatementSubTreeCost="0.00986596" StatementEstRows="1" SecurityPolicyApplied="false" StatementOptmLevel="FULL" QueryHash="0xD25A1302011C9413" QueryPlanHash="0x8A3DAD4BB2189C8F" StatementOptmEarlyAbortReason="GoodEnoughPlanFound" CardinalityEstimationModelVersion="160"><StatementSetOptions QUOTED_IDENTIFIER="true" ARITHABORT="true" CONCAT_NULL_YIELDS_NULL="true" ANSI_NULLS="true" ANSI_PADDING="true" ANSI_WARNINGS="true" NUMERIC_ROUNDABORT="false"></StatementSetOptions><Condition><QueryPlan NonParallelPlanReason="NonParallelizableIntrinsicFunction" CachedPlanSize="40" CompileTime="26" CompileCPU="26" CompileMemory="1096"><MemoryGrantInfo SerialRequiredMemory="0" SerialDesiredMemory="0" GrantedMemory="0" MaxUsedMemory="0"></MemoryGrantInfo><OptimizerHardwareDependentProperties EstimatedAvailableMemoryGrant="40281" EstimatedPagesCached="20140" EstimatedAvailableDegreeOfParallelism="4" MaxCompileMemory="1315768"></OptimizerHardwareDependentProperties><OptimizerStatsUsage><StatisticsInfo LastUpdate="2023-11-13T11:13:38.43" ModificationCount="17" SamplingPercent="100" Statistics="[nc]" Table="[sysidxstats]" Schema="[sys]" Database="[AdventureWorks]"></StatisticsInfo><StatisticsInfo LastUpdate="2009-04-13T12:59:17.36" ModificationCount="331" SamplingPercent="100" Statistics="[clst]" Table="[sysidxstats]" Schema="[sys]" Database="[AdventureWorks]"></StatisticsInfo></OptimizerStatsUsage><RelOp NodeId="0" PhysicalOp="Compute Scalar" LogicalOp="Compute Scalar" EstimateRows="1" EstimateIO="0" EstimateCPU="1e-07" AvgRowSize="11" EstimatedTotalSubtreeCost="0.00986596" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Column="Expr1023"></ColumnReference></OutputList><ComputeScalar><DefinedValues><DefinedValue><ColumnReference Column="Expr1023"></ColumnReference><ScalarOperator ScalarString="CASE WHEN [Expr1024] THEN (1) ELSE (0) END"><IF><Condition><ScalarOperator><Identifier><ColumnReference Column="Expr1024"></ColumnReference></Identifier></ScalarOperator></Condition><Then><ScalarOperator><Const ConstValue="(1)"></Const></ScalarOperator></Then><Else><ScalarOperator><Const ConstValue="(0)"></Const></ScalarOperator></Else></IF></ScalarOperator></DefinedValue></DefinedValues><RelOp NodeId="1" PhysicalOp="Nested Loops" LogicalOp="Left Semi Join" EstimateRows="1" EstimateIO="0" EstimateCPU="4.18e-06" AvgRowSize="9" EstimatedTotalSubtreeCost="0.00986586" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Column="Expr1024"></ColumnReference></OutputList><NestedLoops Optimized="0"><DefinedValues><DefinedValue><ColumnReference Column="Expr1024"></ColumnReference></DefinedValue></DefinedValues><ProbeColumn><ColumnReference Column="Expr1024"></ColumnReference></ProbeColumn><RelOp NodeId="2" PhysicalOp="Constant Scan" LogicalOp="Constant Scan" EstimateRows="1" EstimateIO="0" EstimateCPU="1.157e-06" AvgRowSize="9" EstimatedTotalSubtreeCost="1.157e-06" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList></OutputList><ConstantScan></ConstantScan></RelOp><RelOp NodeId="3" PhysicalOp="Nested Loops" LogicalOp="Inner Join" EstimateRows="1" EstimateIO="0" EstimateCPU="4.18e-06" AvgRowSize="9" EstimatedTotalSubtreeCost="0.00986052" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList></OutputList><NestedLoops Optimized="0"><RelOp NodeId="4" PhysicalOp="Clustered Index Seek" LogicalOp="Clustered Index Seek" EstimateRows="1" EstimatedRowsRead="1" EstimateIO="0.003125" EstimateCPU="0.0001581" AvgRowSize="9" EstimatedTotalSubtreeCost="0.0032831" TableCardinality="2847" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList></OutputList><IndexScan Ordered="1" ScanDirection="FORWARD" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues></DefinedValues><Object Database="[AdventureWorks]" Schema="[sys]" Table="[sysschobjs]" Index="[clst]" Alias="[obj]" IndexKind="Clustered" Storage="RowStore"></Object><SeekPredicates><SeekPredicateNew><SeekKeys><Prefix ScanType="EQ"><RangeColumns><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysschobjs]" Alias="[obj]" Column="id"></ColumnReference></RangeColumns><RangeExpressions><ScalarOperator ScalarString="object_id(N&apos;Users.DeliveryAddress&apos;)"><Intrinsic FunctionName="object_id"><ScalarOperator><Const ConstValue="N&apos;Users.DeliveryAddress&apos;"></Const></ScalarOperator><ScalarOperator><Const ConstValue=""></Const></ScalarOperator></Intrinsic></ScalarOperator></RangeExpressions></Prefix></SeekKeys></SeekPredicateNew></SeekPredicates></IndexScan></RelOp><RelOp NodeId="6" PhysicalOp="Nested Loops" LogicalOp="Inner Join" EstimateRows="1" EstimateIO="0" EstimateCPU="4.18e-06" AvgRowSize="11" EstimatedTotalSubtreeCost="0.00657126" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList></OutputList><NestedLoops Optimized="0"><OuterReferences><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="indid"></ColumnReference></OuterReferences><RelOp NodeId="7" PhysicalOp="Filter" LogicalOp="Filter" EstimateRows="1" EstimateIO="0" EstimateCPU="8.8e-07" AvgRowSize="15" EstimatedTotalSubtreeCost="0.00328398" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="indid"></ColumnReference></OutputList><Filter StartupExpression="0"><RelOp NodeId="8" PhysicalOp="Index Seek" LogicalOp="Index Seek" EstimateRows="1" EstimatedRowsRead="1" EstimateIO="0.003125" EstimateCPU="0.0001581" AvgRowSize="15" EstimatedTotalSubtreeCost="0.0032831" TableCardinality="292" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="indid"></ColumnReference></OutputList><IndexScan Ordered="1" ScanDirection="FORWARD" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="indid"></ColumnReference></DefinedValue></DefinedValues><Object Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Index="[nc]" Alias="[i]" IndexKind="NonClustered" Storage="RowStore"></Object><SeekPredicates><SeekPredicateNew><SeekKeys><Prefix ScanType="EQ"><RangeColumns><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="name"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference></RangeColumns><RangeExpressions><ScalarOperator ScalarString="N&apos;idx_City&apos;"><Const ConstValue="N&apos;idx_City&apos;"></Const></ScalarOperator><ScalarOperator ScalarString="object_id(N&apos;Users.DeliveryAddress&apos;)"><Intrinsic FunctionName="object_id"><ScalarOperator><Const ConstValue="N&apos;Users.DeliveryAddress&apos;"></Const></ScalarOperator><ScalarOperator><Const ConstValue=""></Const></ScalarOperator></Intrinsic></ScalarOperator></RangeExpressions></Prefix></SeekKeys></SeekPredicateNew></SeekPredicates></IndexScan></RelOp><Predicate><ScalarOperator ScalarString="has_access(&apos;CO&apos;,[AdventureWorks].[sys].[sysidxstats].[id] as [i].[id])=(1)"><Compare CompareOp="EQ"><ScalarOperator><Intrinsic FunctionName="has_access"><ScalarOperator><Const ConstValue="&apos;CO&apos;"></Const></ScalarOperator><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue=""></Const></ScalarOperator><ScalarOperator><Const ConstValue=""></Const></ScalarOperator></Intrinsic></ScalarOperator><ScalarOperator><Const ConstValue="(1)"></Const></ScalarOperator></Compare></ScalarOperator></Predicate></Filter></RelOp><RelOp NodeId="10" PhysicalOp="Clustered Index Seek" LogicalOp="Clustered Index Seek" EstimateRows="1" EstimateIO="0.003125" EstimateCPU="0.0001581" AvgRowSize="11" EstimatedTotalSubtreeCost="0.0032831" TableCardinality="292" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList></OutputList><IndexScan Lookup="1" Ordered="1" ScanDirection="FORWARD" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues></DefinedValues><Object Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Index="[clst]" Alias="[i]" TableReferenceId="-1" IndexKind="Clustered" Storage="RowStore"></Object><SeekPredicates><SeekPredicateNew><SeekKeys><Prefix ScanType="EQ"><RangeColumns><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="indid"></ColumnReference></RangeColumns><RangeExpressions><ScalarOperator ScalarString="[AdventureWorks].[sys].[sysidxstats].[id] as [i].[id]"><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference></Identifier></ScalarOperator><ScalarOperator ScalarString="[AdventureWorks].[sys].[sysidxstats].[indid] as [i].[indid]"><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="indid"></ColumnReference></Identifier></ScalarOperator></RangeExpressions></Prefix></SeekKeys></SeekPredicateNew></SeekPredicates><Predicate><ScalarOperator ScalarString="([AdventureWorks].[sys].[sysidxstats].[status] as [i].[status]&amp;(67108864))=(0) AND (([AdventureWorks].[sys].[sysidxstats].[status] as [i].[status]&amp;(1))&lt;(0) OR ([AdventureWorks].[sys].[sysidxstats].[status] as [i].[status]&amp;(1))&gt;(0))"><Logical Operation="AND"><ScalarOperator><Compare CompareOp="EQ"><ScalarOperator><Arithmetic Operation="BIT_AND"><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="status"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue="(67108864)"></Const></ScalarOperator></Arithmetic></ScalarOperator><ScalarOperator><Const ConstValue="(0)"></Const></ScalarOperator></Compare></ScalarOperator><ScalarOperator><Logical Operation="OR"><ScalarOperator><Compare CompareOp="LT"><ScalarOperator><Arithmetic Operation="BIT_AND"><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="status"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue="(1)"></Const></ScalarOperator></Arithmetic></ScalarOperator><ScalarOperator><Const ConstValue="(0)"></Const></ScalarOperator></Compare></ScalarOperator><ScalarOperator><Compare CompareOp="GT"><ScalarOperator><Arithmetic Operation="BIT_AND"><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="status"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue="(1)"></Const></ScalarOperator></Arithmetic></ScalarOperator><ScalarOperator><Const ConstValue="(0)"></Const></ScalarOperator></Compare></ScalarOperator></Logical></ScalarOperator></Logical></ScalarOperator></Predicate></IndexScan></RelOp></NestedLoops></RelOp></NestedLoops></RelOp></NestedLoops></RelOp></ComputeScalar></RelOp></QueryPlan></Condition><Then><Statements><StmtSimple StatementText="&#xd;&#xa;    DROP INDEX idx_City ON Users.DeliveryAddress" StatementId="2" StatementCompId="2" StatementType="DROP INDEX" RetrievedFromCache="true"></StmtSimple></Statements></Then></StmtCond><StmtSimple StatementText=";&#xd;&#xa;&#xd;&#xa;CREATE INDEX idx_City ON Users.DeliveryAddress(City)" StatementId="3" StatementCompId="4" StatementType="CREATE INDEX" RetrievedFromCache="true"></StmtSimple><StmtCond StatementText=";&#xd;&#xa;&#xd;&#xa;/*&#xd;&#xa;Index on OrderDate column in Orders.Sale table&#xd;&#xa;*/&#xd;&#xa;IF EXISTS (SELECT * FROM sys.indexes WHERE name = &apos;idx_OrderDate&apos; AND object_id = OBJECT_ID(&apos;Orders.Sale&apos;))" StatementId="4" StatementCompId="5" StatementType="COND WITH QUERY" StatementSqlHandle="0x09003E952689544EEBEEF1895218C4AFBE200000000000000000000000000000000000000000000000000000" DatabaseContextSettingsId="1" ParentObjectId="0" StatementParameterizationType="0" RetrievedFromCache="true" StatementSubTreeCost="0.00986596" StatementEstRows="1" SecurityPolicyApplied="false" StatementOptmLevel="FULL" QueryHash="0xD25A1302011C9413" QueryPlanHash="0x8A3DAD4BB2189C8F" StatementOptmEarlyAbortReason="GoodEnoughPlanFound" CardinalityEstimationModelVersion="160"><StatementSetOptions QUOTED_IDENTIFIER="true" ARITHABORT="true" CONCAT_NULL_YIELDS_NULL="true" ANSI_NULLS="true" ANSI_PADDING="true" ANSI_WARNINGS="true" NUMERIC_ROUNDABORT="false"></StatementSetOptions><Condition><QueryPlan NonParallelPlanReason="NonParallelizableIntrinsicFunction" CachedPlanSize="40" CompileTime="7" CompileCPU="7" CompileMemory="1096"><MemoryGrantInfo SerialRequiredMemory="0" SerialDesiredMemory="0" GrantedMemory="0" MaxUsedMemory="0"></MemoryGrantInfo><OptimizerHardwareDependentProperties EstimatedAvailableMemoryGrant="40281" EstimatedPagesCached="20140" EstimatedAvailableDegreeOfParallelism="4" MaxCompileMemory="1315768"></OptimizerHardwareDependentProperties><OptimizerStatsUsage><StatisticsInfo LastUpdate="2023-11-13T11:13:38.43" ModificationCount="17" SamplingPercent="100" Statistics="[nc]" Table="[sysidxstats]" Schema="[sys]" Database="[AdventureWorks]"></StatisticsInfo><StatisticsInfo LastUpdate="2009-04-13T12:59:17.36" ModificationCount="331" SamplingPercent="100" Statistics="[clst]" Table="[sysidxstats]" Schema="[sys]" Database="[AdventureWorks]"></StatisticsInfo></OptimizerStatsUsage><RelOp NodeId="0" PhysicalOp="Compute Scalar" LogicalOp="Compute Scalar" EstimateRows="1" EstimateIO="0" EstimateCPU="1e-07" AvgRowSize="11" EstimatedTotalSubtreeCost="0.00986596" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Column="Expr1023"></ColumnReference></OutputList><ComputeScalar><DefinedValues><DefinedValue><ColumnReference Column="Expr1023"></ColumnReference><ScalarOperator ScalarString="CASE WHEN [Expr1024] THEN (1) ELSE (0) END"><IF><Condition><ScalarOperator><Identifier><ColumnReference Column="Expr1024"></ColumnReference></Identifier></ScalarOperator></Condition><Then><ScalarOperator><Const ConstValue="(1)"></Const></ScalarOperator></Then><Else><ScalarOperator><Const ConstValue="(0)"></Const></ScalarOperator></Else></IF></ScalarOperator></DefinedValue></DefinedValues><RelOp NodeId="1" PhysicalOp="Nested Loops" LogicalOp="Left Semi Join" EstimateRows="1" EstimateIO="0" EstimateCPU="4.18e-06" AvgRowSize="9" EstimatedTotalSubtreeCost="0.00986586" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Column="Expr1024"></ColumnReference></OutputList><NestedLoops Optimized="0"><DefinedValues><DefinedValue><ColumnReference Column="Expr1024"></ColumnReference></DefinedValue></DefinedValues><ProbeColumn><ColumnReference Column="Expr1024"></ColumnReference></ProbeColumn><RelOp NodeId="2" PhysicalOp="Constant Scan" LogicalOp="Constant Scan" EstimateRows="1" EstimateIO="0" EstimateCPU="1.157e-06" AvgRowSize="9" EstimatedTotalSubtreeCost="1.157e-06" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList></OutputList><ConstantScan></ConstantScan></RelOp><RelOp NodeId="3" PhysicalOp="Nested Loops" LogicalOp="Inner Join" EstimateRows="1" EstimateIO="0" EstimateCPU="4.18e-06" AvgRowSize="9" EstimatedTotalSubtreeCost="0.00986052" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList></OutputList><NestedLoops Optimized="0"><RelOp NodeId="4" PhysicalOp="Clustered Index Seek" LogicalOp="Clustered Index Seek" EstimateRows="1" EstimatedRowsRead="1" EstimateIO="0.003125" EstimateCPU="0.0001581" AvgRowSize="9" EstimatedTotalSubtreeCost="0.0032831" TableCardinality="2847" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList></OutputList><IndexScan Ordered="1" ScanDirection="FORWARD" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues></DefinedValues><Object Database="[AdventureWorks]" Schema="[sys]" Table="[sysschobjs]" Index="[clst]" Alias="[obj]" IndexKind="Clustered" Storage="RowStore"></Object><SeekPredicates><SeekPredicateNew><SeekKeys><Prefix ScanType="EQ"><RangeColumns><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysschobjs]" Alias="[obj]" Column="id"></ColumnReference></RangeColumns><RangeExpressions><ScalarOperator ScalarString="object_id(N&apos;Orders.Sale&apos;)"><Intrinsic FunctionName="object_id"><ScalarOperator><Const ConstValue="N&apos;Orders.Sale&apos;"></Const></ScalarOperator><ScalarOperator><Const ConstValue=""></Const></ScalarOperator></Intrinsic></ScalarOperator></RangeExpressions></Prefix></SeekKeys></SeekPredicateNew></SeekPredicates></IndexScan></RelOp><RelOp NodeId="6" PhysicalOp="Nested Loops" LogicalOp="Inner Join" EstimateRows="1" EstimateIO="0" EstimateCPU="4.18e-06" AvgRowSize="11" EstimatedTotalSubtreeCost="0.00657126" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList></OutputList><NestedLoops Optimized="0"><OuterReferences><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="indid"></ColumnReference></OuterReferences><RelOp NodeId="7" PhysicalOp="Filter" LogicalOp="Filter" EstimateRows="1" EstimateIO="0" EstimateCPU="8.8e-07" AvgRowSize="15" EstimatedTotalSubtreeCost="0.00328398" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="indid"></ColumnReference></OutputList><Filter StartupExpression="0"><RelOp NodeId="8" PhysicalOp="Index Seek" LogicalOp="Index Seek" EstimateRows="1" EstimatedRowsRead="1" EstimateIO="0.003125" EstimateCPU="0.0001581" AvgRowSize="15" EstimatedTotalSubtreeCost="0.0032831" TableCardinality="292" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="indid"></ColumnReference></OutputList><IndexScan Ordered="1" ScanDirection="FORWARD" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="indid"></ColumnReference></DefinedValue></DefinedValues><Object Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Index="[nc]" Alias="[i]" IndexKind="NonClustered" Storage="RowStore"></Object><SeekPredicates><SeekPredicateNew><SeekKeys><Prefix ScanType="EQ"><RangeColumns><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="name"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference></RangeColumns><RangeExpressions><ScalarOperator ScalarString="N&apos;idx_OrderDate&apos;"><Const ConstValue="N&apos;idx_OrderDate&apos;"></Const></ScalarOperator><ScalarOperator ScalarString="object_id(N&apos;Orders.Sale&apos;)"><Intrinsic FunctionName="object_id"><ScalarOperator><Const ConstValue="N&apos;Orders.Sale&apos;"></Const></ScalarOperator><ScalarOperator><Const ConstValue=""></Const></ScalarOperator></Intrinsic></ScalarOperator></RangeExpressions></Prefix></SeekKeys></SeekPredicateNew></SeekPredicates></IndexScan></RelOp><Predicate><ScalarOperator ScalarString="has_access(&apos;CO&apos;,[AdventureWorks].[sys].[sysidxstats].[id] as [i].[id])=(1)"><Compare CompareOp="EQ"><ScalarOperator><Intrinsic FunctionName="has_access"><ScalarOperator><Const ConstValue="&apos;CO&apos;"></Const></ScalarOperator><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue=""></Const></ScalarOperator><ScalarOperator><Const ConstValue=""></Const></ScalarOperator></Intrinsic></ScalarOperator><ScalarOperator><Const ConstValue="(1)"></Const></ScalarOperator></Compare></ScalarOperator></Predicate></Filter></RelOp><RelOp NodeId="10" PhysicalOp="Clustered Index Seek" LogicalOp="Clustered Index Seek" EstimateRows="1" EstimateIO="0.003125" EstimateCPU="0.0001581" AvgRowSize="11" EstimatedTotalSubtreeCost="0.0032831" TableCardinality="292" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList></OutputList><IndexScan Lookup="1" Ordered="1" ScanDirection="FORWARD" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues></DefinedValues><Object Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Index="[clst]" Alias="[i]" TableReferenceId="-1" IndexKind="Clustered" Storage="RowStore"></Object><SeekPredicates><SeekPredicateNew><SeekKeys><Prefix ScanType="EQ"><RangeColumns><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="indid"></ColumnReference></RangeColumns><RangeExpressions><ScalarOperator ScalarString="[AdventureWorks].[sys].[sysidxstats].[id] as [i].[id]"><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference></Identifier></ScalarOperator><ScalarOperator ScalarString="[AdventureWorks].[sys].[sysidxstats].[indid] as [i].[indid]"><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="indid"></ColumnReference></Identifier></ScalarOperator></RangeExpressions></Prefix></SeekKeys></SeekPredicateNew></SeekPredicates><Predicate><ScalarOperator ScalarString="([AdventureWorks].[sys].[sysidxstats].[status] as [i].[status]&amp;(67108864))=(0) AND (([AdventureWorks].[sys].[sysidxstats].[status] as [i].[status]&amp;(1))&lt;(0) OR ([AdventureWorks].[sys].[sysidxstats].[status] as [i].[status]&amp;(1))&gt;(0))"><Logical Operation="AND"><ScalarOperator><Compare CompareOp="EQ"><ScalarOperator><Arithmetic Operation="BIT_AND"><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="status"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue="(67108864)"></Const></ScalarOperator></Arithmetic></ScalarOperator><ScalarOperator><Const ConstValue="(0)"></Const></ScalarOperator></Compare></ScalarOperator><ScalarOperator><Logical Operation="OR"><ScalarOperator><Compare CompareOp="LT"><ScalarOperator><Arithmetic Operation="BIT_AND"><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="status"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue="(1)"></Const></ScalarOperator></Arithmetic></ScalarOperator><ScalarOperator><Const ConstValue="(0)"></Const></ScalarOperator></Compare></ScalarOperator><ScalarOperator><Compare CompareOp="GT"><ScalarOperator><Arithmetic Operation="BIT_AND"><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="status"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue="(1)"></Const></ScalarOperator></Arithmetic></ScalarOperator><ScalarOperator><Const ConstValue="(0)"></Const></ScalarOperator></Compare></ScalarOperator></Logical></ScalarOperator></Logical></ScalarOperator></Predicate></IndexScan></RelOp></NestedLoops></RelOp></NestedLoops></RelOp></NestedLoops></RelOp></ComputeScalar></RelOp></QueryPlan></Condition><Then><Statements><StmtSimple StatementText="&#xd;&#xa;    DROP INDEX idx_OrderDate ON Orders.Sale" StatementId="5" StatementCompId="6" StatementType="DROP INDEX" RetrievedFromCache="true"></StmtSimple></Statements></Then></StmtCond><StmtSimple StatementText=";&#xd;&#xa;&#xd;&#xa;CREATE INDEX idx_OrderDate ON Orders.Sale(OrderDate)" StatementId="6" StatementCompId="8" StatementType="CREATE INDEX" RetrievedFromCache="true"></StmtSimple><StmtCond StatementText=";&#xd;&#xa;&#xd;&#xa;/*&#xd;&#xa;Index on Color column in Products.ProductModel table&#xd;&#xa;*/&#xd;&#xa;IF EXISTS (SELECT * FROM sys.indexes WHERE name = &apos;idx_Color&apos; AND object_id = OBJECT_ID(&apos;Products.ProductModel&apos;))" StatementId="7" StatementCompId="9" StatementType="COND WITH QUERY" StatementSqlHandle="0x09003C3A247DBA301D531970CA0CF4F7F82D0000000000000000000000000000000000000000000000000000" DatabaseContextSettingsId="1" ParentObjectId="0" StatementParameterizationType="0" RetrievedFromCache="true" StatementSubTreeCost="0.00986596" StatementEstRows="1" SecurityPolicyApplied="false" StatementOptmLevel="FULL" QueryHash="0xD25A1302011C9413" QueryPlanHash="0x8A3DAD4BB2189C8F" StatementOptmEarlyAbortReason="GoodEnoughPlanFound" CardinalityEstimationModelVersion="160"><StatementSetOptions QUOTED_IDENTIFIER="true" ARITHABORT="true" CONCAT_NULL_YIELDS_NULL="true" ANSI_NULLS="true" ANSI_PADDING="true" ANSI_WARNINGS="true" NUMERIC_ROUNDABORT="false"></StatementSetOptions><Condition><QueryPlan NonParallelPlanReason="NonParallelizableIntrinsicFunction" CachedPlanSize="40" CompileTime="7" CompileCPU="7" CompileMemory="1096"><MemoryGrantInfo SerialRequiredMemory="0" SerialDesiredMemory="0" GrantedMemory="0" MaxUsedMemory="0"></MemoryGrantInfo><OptimizerHardwareDependentProperties EstimatedAvailableMemoryGrant="40281" EstimatedPagesCached="20140" EstimatedAvailableDegreeOfParallelism="4" MaxCompileMemory="1315768"></OptimizerHardwareDependentProperties><OptimizerStatsUsage><StatisticsInfo LastUpdate="2023-11-13T11:13:38.43" ModificationCount="17" SamplingPercent="100" Statistics="[nc]" Table="[sysidxstats]" Schema="[sys]" Database="[AdventureWorks]"></StatisticsInfo><StatisticsInfo LastUpdate="2009-04-13T12:59:17.36" ModificationCount="331" SamplingPercent="100" Statistics="[clst]" Table="[sysidxstats]" Schema="[sys]" Database="[AdventureWorks]"></StatisticsInfo></OptimizerStatsUsage><RelOp NodeId="0" PhysicalOp="Compute Scalar" LogicalOp="Compute Scalar" EstimateRows="1" EstimateIO="0" EstimateCPU="1e-07" AvgRowSize="11" EstimatedTotalSubtreeCost="0.00986596" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Column="Expr1023"></ColumnReference></OutputList><ComputeScalar><DefinedValues><DefinedValue><ColumnReference Column="Expr1023"></ColumnReference><ScalarOperator ScalarString="CASE WHEN [Expr1024] THEN (1) ELSE (0) END"><IF><Condition><ScalarOperator><Identifier><ColumnReference Column="Expr1024"></ColumnReference></Identifier></ScalarOperator></Condition><Then><ScalarOperator><Const ConstValue="(1)"></Const></ScalarOperator></Then><Else><ScalarOperator><Const ConstValue="(0)"></Const></ScalarOperator></Else></IF></ScalarOperator></DefinedValue></DefinedValues><RelOp NodeId="1" PhysicalOp="Nested Loops" LogicalOp="Left Semi Join" EstimateRows="1" EstimateIO="0" EstimateCPU="4.18e-06" AvgRowSize="9" EstimatedTotalSubtreeCost="0.00986586" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Column="Expr1024"></ColumnReference></OutputList><NestedLoops Optimized="0"><DefinedValues><DefinedValue><ColumnReference Column="Expr1024"></ColumnReference></DefinedValue></DefinedValues><ProbeColumn><ColumnReference Column="Expr1024"></ColumnReference></ProbeColumn><RelOp NodeId="2" PhysicalOp="Constant Scan" LogicalOp="Constant Scan" EstimateRows="1" EstimateIO="0" EstimateCPU="1.157e-06" AvgRowSize="9" EstimatedTotalSubtreeCost="1.157e-06" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList></OutputList><ConstantScan></ConstantScan></RelOp><RelOp NodeId="3" PhysicalOp="Nested Loops" LogicalOp="Inner Join" EstimateRows="1" EstimateIO="0" EstimateCPU="4.18e-06" AvgRowSize="9" EstimatedTotalSubtreeCost="0.00986052" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList></OutputList><NestedLoops Optimized="0"><RelOp NodeId="4" PhysicalOp="Clustered Index Seek" LogicalOp="Clustered Index Seek" EstimateRows="1" EstimatedRowsRead="1" EstimateIO="0.003125" EstimateCPU="0.0001581" AvgRowSize="9" EstimatedTotalSubtreeCost="0.0032831" TableCardinality="2847" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList></OutputList><IndexScan Ordered="1" ScanDirection="FORWARD" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues></DefinedValues><Object Database="[AdventureWorks]" Schema="[sys]" Table="[sysschobjs]" Index="[clst]" Alias="[obj]" IndexKind="Clustered" Storage="RowStore"></Object><SeekPredicates><SeekPredicateNew><SeekKeys><Prefix ScanType="EQ"><RangeColumns><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysschobjs]" Alias="[obj]" Column="id"></ColumnReference></RangeColumns><RangeExpressions><ScalarOperator ScalarString="object_id(N&apos;Products.ProductModel&apos;)"><Intrinsic FunctionName="object_id"><ScalarOperator><Const ConstValue="N&apos;Products.ProductModel&apos;"></Const></ScalarOperator><ScalarOperator><Const ConstValue=""></Const></ScalarOperator></Intrinsic></ScalarOperator></RangeExpressions></Prefix></SeekKeys></SeekPredicateNew></SeekPredicates></IndexScan></RelOp><RelOp NodeId="6" PhysicalOp="Nested Loops" LogicalOp="Inner Join" EstimateRows="1" EstimateIO="0" EstimateCPU="4.18e-06" AvgRowSize="11" EstimatedTotalSubtreeCost="0.00657126" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList></OutputList><NestedLoops Optimized="0"><OuterReferences><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="indid"></ColumnReference></OuterReferences><RelOp NodeId="7" PhysicalOp="Filter" LogicalOp="Filter" EstimateRows="1" EstimateIO="0" EstimateCPU="8.8e-07" AvgRowSize="15" EstimatedTotalSubtreeCost="0.00328398" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="indid"></ColumnReference></OutputList><Filter StartupExpression="0"><RelOp NodeId="8" PhysicalOp="Index Seek" LogicalOp="Index Seek" EstimateRows="1" EstimatedRowsRead="1" EstimateIO="0.003125" EstimateCPU="0.0001581" AvgRowSize="15" EstimatedTotalSubtreeCost="0.0032831" TableCardinality="292" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="indid"></ColumnReference></OutputList><IndexScan Ordered="1" ScanDirection="FORWARD" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="indid"></ColumnReference></DefinedValue></DefinedValues><Object Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Index="[nc]" Alias="[i]" IndexKind="NonClustered" Storage="RowStore"></Object><SeekPredicates><SeekPredicateNew><SeekKeys><Prefix ScanType="EQ"><RangeColumns><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="name"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference></RangeColumns><RangeExpressions><ScalarOperator ScalarString="N&apos;idx_Color&apos;"><Const ConstValue="N&apos;idx_Color&apos;"></Const></ScalarOperator><ScalarOperator ScalarString="object_id(N&apos;Products.ProductModel&apos;)"><Intrinsic FunctionName="object_id"><ScalarOperator><Const ConstValue="N&apos;Products.ProductModel&apos;"></Const></ScalarOperator><ScalarOperator><Const ConstValue=""></Const></ScalarOperator></Intrinsic></ScalarOperator></RangeExpressions></Prefix></SeekKeys></SeekPredicateNew></SeekPredicates></IndexScan></RelOp><Predicate><ScalarOperator ScalarString="has_access(&apos;CO&apos;,[AdventureWorks].[sys].[sysidxstats].[id] as [i].[id])=(1)"><Compare CompareOp="EQ"><ScalarOperator><Intrinsic FunctionName="has_access"><ScalarOperator><Const ConstValue="&apos;CO&apos;"></Const></ScalarOperator><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue=""></Const></ScalarOperator><ScalarOperator><Const ConstValue=""></Const></ScalarOperator></Intrinsic></ScalarOperator><ScalarOperator><Const ConstValue="(1)"></Const></ScalarOperator></Compare></ScalarOperator></Predicate></Filter></RelOp><RelOp NodeId="10" PhysicalOp="Clustered Index Seek" LogicalOp="Clustered Index Seek" EstimateRows="1" EstimateIO="0.003125" EstimateCPU="0.0001581" AvgRowSize="11" EstimatedTotalSubtreeCost="0.0032831" TableCardinality="292" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList></OutputList><IndexScan Lookup="1" Ordered="1" ScanDirection="FORWARD" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues></DefinedValues><Object Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Index="[clst]" Alias="[i]" TableReferenceId="-1" IndexKind="Clustered" Storage="RowStore"></Object><SeekPredicates><SeekPredicateNew><SeekKeys><Prefix ScanType="EQ"><RangeColumns><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="indid"></ColumnReference></RangeColumns><RangeExpressions><ScalarOperator ScalarString="[AdventureWorks].[sys].[sysidxstats].[id] as [i].[id]"><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference></Identifier></ScalarOperator><ScalarOperator ScalarString="[AdventureWorks].[sys].[sysidxstats].[indid] as [i].[indid]"><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="indid"></ColumnReference></Identifier></ScalarOperator></RangeExpressions></Prefix></SeekKeys></SeekPredicateNew></SeekPredicates><Predicate><ScalarOperator ScalarString="([AdventureWorks].[sys].[sysidxstats].[status] as [i].[status]&amp;(67108864))=(0) AND (([AdventureWorks].[sys].[sysidxstats].[status] as [i].[status]&amp;(1))&lt;(0) OR ([AdventureWorks].[sys].[sysidxstats].[status] as [i].[status]&amp;(1))&gt;(0))"><Logical Operation="AND"><ScalarOperator><Compare CompareOp="EQ"><ScalarOperator><Arithmetic Operation="BIT_AND"><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="status"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue="(67108864)"></Const></ScalarOperator></Arithmetic></ScalarOperator><ScalarOperator><Const ConstValue="(0)"></Const></ScalarOperator></Compare></ScalarOperator><ScalarOperator><Logical Operation="OR"><ScalarOperator><Compare CompareOp="LT"><ScalarOperator><Arithmetic Operation="BIT_AND"><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="status"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue="(1)"></Const></ScalarOperator></Arithmetic></ScalarOperator><ScalarOperator><Const ConstValue="(0)"></Const></ScalarOperator></Compare></ScalarOperator><ScalarOperator><Compare CompareOp="GT"><ScalarOperator><Arithmetic Operation="BIT_AND"><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="status"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue="(1)"></Const></ScalarOperator></Arithmetic></ScalarOperator><ScalarOperator><Const ConstValue="(0)"></Const></ScalarOperator></Compare></ScalarOperator></Logical></ScalarOperator></Logical></ScalarOperator></Predicate></IndexScan></RelOp></NestedLoops></RelOp></NestedLoops></RelOp></NestedLoops></RelOp></ComputeScalar></RelOp></QueryPlan></Condition><Then><Statements><StmtSimple StatementText="&#xd;&#xa;    DROP INDEX idx_Color ON Products.ProductModel" StatementId="8" StatementCompId="10" StatementType="DROP INDEX" RetrievedFromCache="true"></StmtSimple></Statements></Then></StmtCond><StmtSimple StatementText=";&#xd;&#xa;&#xd;&#xa;CREATE INDEX idx_Color ON Products.ProductModel(Color)" StatementId="9" StatementCompId="12" StatementType="CREATE INDEX" RetrievedFromCache="true"></StmtSimple><StmtCond StatementText=";&#xd;&#xa;&#xd;&#xa;/*&#xd;&#xa;Index on CategoryKey column in Products.Product table&#xd;&#xa;*/&#xd;&#xa;IF EXISTS (SELECT * FROM sys.indexes WHERE name = &apos;idx_CategoryKey&apos; AND object_id = OBJECT_ID(&apos;Products.Product&apos;))" StatementId="10" StatementCompId="13" StatementType="COND WITH QUERY" StatementSqlHandle="0x09006F5FB06599BC1543F02AE5AC0BDB88370000000000000000000000000000000000000000000000000000" DatabaseContextSettingsId="1" ParentObjectId="0" StatementParameterizationType="0" RetrievedFromCache="true" StatementSubTreeCost="0.00986596" StatementEstRows="1" SecurityPolicyApplied="false" StatementOptmLevel="FULL" QueryHash="0xD25A1302011C9413" QueryPlanHash="0x8A3DAD4BB2189C8F" StatementOptmEarlyAbortReason="GoodEnoughPlanFound" CardinalityEstimationModelVersion="160"><StatementSetOptions QUOTED_IDENTIFIER="true" ARITHABORT="true" CONCAT_NULL_YIELDS_NULL="true" ANSI_NULLS="true" ANSI_PADDING="true" ANSI_WARNINGS="true" NUMERIC_ROUNDABORT="false"></StatementSetOptions><Condition><QueryPlan NonParallelPlanReason="NonParallelizableIntrinsicFunction" CachedPlanSize="40" CompileTime="6" CompileCPU="6" CompileMemory="1096"><MemoryGrantInfo SerialRequiredMemory="0" SerialDesiredMemory="0" GrantedMemory="0" MaxUsedMemory="0"></MemoryGrantInfo><OptimizerHardwareDependentProperties EstimatedAvailableMemoryGrant="40281" EstimatedPagesCached="20140" EstimatedAvailableDegreeOfParallelism="4" MaxCompileMemory="1315768"></OptimizerHardwareDependentProperties><OptimizerStatsUsage><StatisticsInfo LastUpdate="2023-11-13T11:13:38.43" ModificationCount="17" SamplingPercent="100" Statistics="[nc]" Table="[sysidxstats]" Schema="[sys]" Database="[AdventureWorks]"></StatisticsInfo><StatisticsInfo LastUpdate="2009-04-13T12:59:17.36" ModificationCount="331" SamplingPercent="100" Statistics="[clst]" Table="[sysidxstats]" Schema="[sys]" Database="[AdventureWorks]"></StatisticsInfo></OptimizerStatsUsage><RelOp NodeId="0" PhysicalOp="Compute Scalar" LogicalOp="Compute Scalar" EstimateRows="1" EstimateIO="0" EstimateCPU="1e-07" AvgRowSize="11" EstimatedTotalSubtreeCost="0.00986596" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Column="Expr1023"></ColumnReference></OutputList><ComputeScalar><DefinedValues><DefinedValue><ColumnReference Column="Expr1023"></ColumnReference><ScalarOperator ScalarString="CASE WHEN [Expr1024] THEN (1) ELSE (0) END"><IF><Condition><ScalarOperator><Identifier><ColumnReference Column="Expr1024"></ColumnReference></Identifier></ScalarOperator></Condition><Then><ScalarOperator><Const ConstValue="(1)"></Const></ScalarOperator></Then><Else><ScalarOperator><Const ConstValue="(0)"></Const></ScalarOperator></Else></IF></ScalarOperator></DefinedValue></DefinedValues><RelOp NodeId="1" PhysicalOp="Nested Loops" LogicalOp="Left Semi Join" EstimateRows="1" EstimateIO="0" EstimateCPU="4.18e-06" AvgRowSize="9" EstimatedTotalSubtreeCost="0.00986586" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Column="Expr1024"></ColumnReference></OutputList><NestedLoops Optimized="0"><DefinedValues><DefinedValue><ColumnReference Column="Expr1024"></ColumnReference></DefinedValue></DefinedValues><ProbeColumn><ColumnReference Column="Expr1024"></ColumnReference></ProbeColumn><RelOp NodeId="2" PhysicalOp="Constant Scan" LogicalOp="Constant Scan" EstimateRows="1" EstimateIO="0" EstimateCPU="1.157e-06" AvgRowSize="9" EstimatedTotalSubtreeCost="1.157e-06" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList></OutputList><ConstantScan></ConstantScan></RelOp><RelOp NodeId="3" PhysicalOp="Nested Loops" LogicalOp="Inner Join" EstimateRows="1" EstimateIO="0" EstimateCPU="4.18e-06" AvgRowSize="9" EstimatedTotalSubtreeCost="0.00986052" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList></OutputList><NestedLoops Optimized="0"><RelOp NodeId="4" PhysicalOp="Clustered Index Seek" LogicalOp="Clustered Index Seek" EstimateRows="1" EstimatedRowsRead="1" EstimateIO="0.003125" EstimateCPU="0.0001581" AvgRowSize="9" EstimatedTotalSubtreeCost="0.0032831" TableCardinality="2847" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList></OutputList><IndexScan Ordered="1" ScanDirection="FORWARD" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues></DefinedValues><Object Database="[AdventureWorks]" Schema="[sys]" Table="[sysschobjs]" Index="[clst]" Alias="[obj]" IndexKind="Clustered" Storage="RowStore"></Object><SeekPredicates><SeekPredicateNew><SeekKeys><Prefix ScanType="EQ"><RangeColumns><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysschobjs]" Alias="[obj]" Column="id"></ColumnReference></RangeColumns><RangeExpressions><ScalarOperator ScalarString="object_id(N&apos;Products.Product&apos;)"><Intrinsic FunctionName="object_id"><ScalarOperator><Const ConstValue="N&apos;Products.Product&apos;"></Const></ScalarOperator><ScalarOperator><Const ConstValue=""></Const></ScalarOperator></Intrinsic></ScalarOperator></RangeExpressions></Prefix></SeekKeys></SeekPredicateNew></SeekPredicates></IndexScan></RelOp><RelOp NodeId="6" PhysicalOp="Nested Loops" LogicalOp="Inner Join" EstimateRows="1" EstimateIO="0" EstimateCPU="4.18e-06" AvgRowSize="11" EstimatedTotalSubtreeCost="0.00657126" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList></OutputList><NestedLoops Optimized="0"><OuterReferences><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="indid"></ColumnReference></OuterReferences><RelOp NodeId="7" PhysicalOp="Filter" LogicalOp="Filter" EstimateRows="1" EstimateIO="0" EstimateCPU="8.8e-07" AvgRowSize="15" EstimatedTotalSubtreeCost="0.00328398" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="indid"></ColumnReference></OutputList><Filter StartupExpression="0"><RelOp NodeId="8" PhysicalOp="Index Seek" LogicalOp="Index Seek" EstimateRows="1" EstimatedRowsRead="1" EstimateIO="0.003125" EstimateCPU="0.0001581" AvgRowSize="15" EstimatedTotalSubtreeCost="0.0032831" TableCardinality="292" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="indid"></ColumnReference></OutputList><IndexScan Ordered="1" ScanDirection="FORWARD" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="indid"></ColumnReference></DefinedValue></DefinedValues><Object Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Index="[nc]" Alias="[i]" IndexKind="NonClustered" Storage="RowStore"></Object><SeekPredicates><SeekPredicateNew><SeekKeys><Prefix ScanType="EQ"><RangeColumns><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="name"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference></RangeColumns><RangeExpressions><ScalarOperator ScalarString="N&apos;idx_CategoryKey&apos;"><Const ConstValue="N&apos;idx_CategoryKey&apos;"></Const></ScalarOperator><ScalarOperator ScalarString="object_id(N&apos;Products.Product&apos;)"><Intrinsic FunctionName="object_id"><ScalarOperator><Const ConstValue="N&apos;Products.Product&apos;"></Const></ScalarOperator><ScalarOperator><Const ConstValue=""></Const></ScalarOperator></Intrinsic></ScalarOperator></RangeExpressions></Prefix></SeekKeys></SeekPredicateNew></SeekPredicates></IndexScan></RelOp><Predicate><ScalarOperator ScalarString="has_access(&apos;CO&apos;,[AdventureWorks].[sys].[sysidxstats].[id] as [i].[id])=(1)"><Compare CompareOp="EQ"><ScalarOperator><Intrinsic FunctionName="has_access"><ScalarOperator><Const ConstValue="&apos;CO&apos;"></Const></ScalarOperator><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue=""></Const></ScalarOperator><ScalarOperator><Const ConstValue=""></Const></ScalarOperator></Intrinsic></ScalarOperator><ScalarOperator><Const ConstValue="(1)"></Const></ScalarOperator></Compare></ScalarOperator></Predicate></Filter></RelOp><RelOp NodeId="10" PhysicalOp="Clustered Index Seek" LogicalOp="Clustered Index Seek" EstimateRows="1" EstimateIO="0.003125" EstimateCPU="0.0001581" AvgRowSize="11" EstimatedTotalSubtreeCost="0.0032831" TableCardinality="292" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList></OutputList><IndexScan Lookup="1" Ordered="1" ScanDirection="FORWARD" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues></DefinedValues><Object Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Index="[clst]" Alias="[i]" TableReferenceId="-1" IndexKind="Clustered" Storage="RowStore"></Object><SeekPredicates><SeekPredicateNew><SeekKeys><Prefix ScanType="EQ"><RangeColumns><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="indid"></ColumnReference></RangeColumns><RangeExpressions><ScalarOperator ScalarString="[AdventureWorks].[sys].[sysidxstats].[id] as [i].[id]"><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="id"></ColumnReference></Identifier></ScalarOperator><ScalarOperator ScalarString="[AdventureWorks].[sys].[sysidxstats].[indid] as [i].[indid]"><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="indid"></ColumnReference></Identifier></ScalarOperator></RangeExpressions></Prefix></SeekKeys></SeekPredicateNew></SeekPredicates><Predicate><ScalarOperator ScalarString="([AdventureWorks].[sys].[sysidxstats].[status] as [i].[status]&amp;(67108864))=(0) AND (([AdventureWorks].[sys].[sysidxstats].[status] as [i].[status]&amp;(1))&lt;(0) OR ([AdventureWorks].[sys].[sysidxstats].[status] as [i].[status]&amp;(1))&gt;(0))"><Logical Operation="AND"><ScalarOperator><Compare CompareOp="EQ"><ScalarOperator><Arithmetic Operation="BIT_AND"><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="status"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue="(67108864)"></Const></ScalarOperator></Arithmetic></ScalarOperator><ScalarOperator><Const ConstValue="(0)"></Const></ScalarOperator></Compare></ScalarOperator><ScalarOperator><Logical Operation="OR"><ScalarOperator><Compare CompareOp="LT"><ScalarOperator><Arithmetic Operation="BIT_AND"><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="status"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue="(1)"></Const></ScalarOperator></Arithmetic></ScalarOperator><ScalarOperator><Const ConstValue="(0)"></Const></ScalarOperator></Compare></ScalarOperator><ScalarOperator><Compare CompareOp="GT"><ScalarOperator><Arithmetic Operation="BIT_AND"><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[sys]" Table="[sysidxstats]" Alias="[i]" Column="status"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue="(1)"></Const></ScalarOperator></Arithmetic></ScalarOperator><ScalarOperator><Const ConstValue="(0)"></Const></ScalarOperator></Compare></ScalarOperator></Logical></ScalarOperator></Logical></ScalarOperator></Predicate></IndexScan></RelOp></NestedLoops></RelOp></NestedLoops></RelOp></NestedLoops></RelOp></ComputeScalar></RelOp></QueryPlan></Condition><Then><Statements><StmtSimple StatementText="&#xd;&#xa;    DROP INDEX idx_CategoryKey ON Products.Product" StatementId="11" StatementCompId="14" StatementType="DROP INDEX" RetrievedFromCache="true"></StmtSimple></Statements></Then></StmtCond><StmtSimple StatementText=";&#xd;&#xa;&#xd;&#xa;CREATE INDEX idx_CategoryKey ON Products.Product(CategoryKey)" StatementId="12" StatementCompId="16" StatementType="CREATE INDEX" RetrievedFromCache="true"></StmtSimple><StmtSimple StatementText=";&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;/*&#xd;&#xa;Query city &#xd;&#xa;*/&#xd;&#xa;&#xd;&#xa;SELECT&#xd;&#xa;    DA.City,&#xd;&#xa;    DA.StateProvinceCode,&#xd;&#xa;    ST.SalesTerritoryRegion,&#xd;&#xa;    SUM(OP.SalesAmount) AS TotalSales&#xd;&#xa;FROM&#xd;&#xa;    Users.DeliveryAddress DA&#xd;&#xa;    JOIN Defaults.SaleTerritory ST ON DA.SaleTerritoryKey = ST.SaleTerritoryKey&#xd;&#xa;    JOIN Orders.Sale S ON ST.SaleTerritoryKey = S.SaleTerritoryKey&#xd;&#xa;    JOIN Orders.OrderedProducts OP ON S.SaleKey = OP.SaleKey&#xd;&#xa;GROUP BY&#xd;&#xa;    DA.City, DA.StateProvinceCode, ST.SalesTerritoryRegion" StatementId="13" StatementCompId="17" StatementType="SELECT" StatementSqlHandle="0x0900EF52551B1246033DB2EA611C80585D670000000000000000000000000000000000000000000000000000" DatabaseContextSettingsId="1" ParentObjectId="0" StatementParameterizationType="0" RetrievedFromCache="true" StatementSubTreeCost="1.26365" StatementEstRows="3015.08" SecurityPolicyApplied="false" StatementOptmLevel="FULL" QueryHash="0x525EB19358E14990" QueryPlanHash="0x2AB1491CE159AA25" StatementOptmEarlyAbortReason="TimeOut" CardinalityEstimationModelVersion="160"><StatementSetOptions QUOTED_IDENTIFIER="true" ARITHABORT="true" CONCAT_NULL_YIELDS_NULL="true" ANSI_NULLS="true" ANSI_PADDING="true" ANSI_WARNINGS="true" NUMERIC_ROUNDABORT="false"></StatementSetOptions><QueryPlan CachedPlanSize="128" CompileTime="12" CompileCPU="12" CompileMemory="800"><MissingIndexes><MissingIndexGroup Impact="35.9884"><MissingIndex Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]"><ColumnGroup Usage="EQUALITY"><Column Name="[SaleKey]" ColumnId="11"></Column></ColumnGroup><ColumnGroup Usage="INCLUDE"><Column Name="[SalesAmount]" ColumnId="5"></Column></ColumnGroup></MissingIndex></MissingIndexGroup><MissingIndexGroup Impact="29.9314"><MissingIndex Database="[AdventureWorks]" Schema="[Users]" Table="[DeliveryAddress]"><ColumnGroup Usage="EQUALITY"><Column Name="[SaleTerritoryKey]" ColumnId="11"></Column></ColumnGroup><ColumnGroup Usage="INCLUDE"><Column Name="[City]" ColumnId="4"></Column><Column Name="[StateProvinceCode]" ColumnId="6"></Column></ColumnGroup></MissingIndex></MissingIndexGroup></MissingIndexes><MemoryGrantInfo SerialRequiredMemory="3072" SerialDesiredMemory="5928" GrantedMemory="0" MaxUsedMemory="0"></MemoryGrantInfo><OptimizerHardwareDependentProperties EstimatedAvailableMemoryGrant="40281" EstimatedPagesCached="20140" EstimatedAvailableDegreeOfParallelism="4" MaxCompileMemory="1315768"></OptimizerHardwareDependentProperties><OptimizerStatsUsage><StatisticsInfo LastUpdate="2024-01-20T23:17:58.71" ModificationCount="0" SamplingPercent="100" Statistics="[_WA_Sys_00000006_3F466844]" Table="[DeliveryAddress]" Schema="[Users]" Database="[AdventureWorks]"></StatisticsInfo><StatisticsInfo LastUpdate="2024-01-20T23:17:58.69" ModificationCount="0" SamplingPercent="100" Statistics="[_WA_Sys_00000004_3F466844]" Table="[DeliveryAddress]" Schema="[Users]" Database="[AdventureWorks]"></StatisticsInfo><StatisticsInfo LastUpdate="2024-01-20T23:17:58.64" ModificationCount="0" SamplingPercent="100" Statistics="[_WA_Sys_0000000B_5441852A]" Table="[Sale]" Schema="[Orders]" Database="[AdventureWorks]"></StatisticsInfo><StatisticsInfo LastUpdate="2024-01-20T23:17:58.64" ModificationCount="0" SamplingPercent="100" Statistics="[PK__Sale__1C32977D6843DCA0]" Table="[Sale]" Schema="[Orders]" Database="[AdventureWorks]"></StatisticsInfo><StatisticsInfo LastUpdate="2024-01-20T23:17:58.62" ModificationCount="0" SamplingPercent="100" Statistics="[_WA_Sys_0000000B_3F466844]" Table="[DeliveryAddress]" Schema="[Users]" Database="[AdventureWorks]"></StatisticsInfo><StatisticsInfo LastUpdate="2024-01-21T01:14:19.24" ModificationCount="0" SamplingPercent="100" Statistics="[idx_City]" Table="[DeliveryAddress]" Schema="[Users]" Database="[AdventureWorks]"></StatisticsInfo><StatisticsInfo LastUpdate="2024-01-20T23:17:58.67" ModificationCount="0" SamplingPercent="100" Statistics="[_WA_Sys_0000000B_628FA481]" Table="[OrderedProducts]" Schema="[Orders]" Database="[AdventureWorks]"></StatisticsInfo><StatisticsInfo LastUpdate="2024-01-20T23:17:58.62" ModificationCount="0" SamplingPercent="100" Statistics="[PK__SaleTerr__218AE9E059468BD8]" Table="[SaleTerritory]" Schema="[Defaults]" Database="[AdventureWorks]"></StatisticsInfo><StatisticsInfo LastUpdate="2024-01-20T23:17:58.72" ModificationCount="0" SamplingPercent="100" Statistics="[_WA_Sys_00000002_3B75D760]" Table="[SaleTerritory]" Schema="[Defaults]" Database="[AdventureWorks]"></StatisticsInfo><StatisticsInfo LastUpdate="2024-01-21T01:14:19.26" ModificationCount="0" SamplingPercent="100" Statistics="[idx_OrderDate]" Table="[Sale]" Schema="[Orders]" Database="[AdventureWorks]"></StatisticsInfo></OptimizerStatsUsage><RelOp NodeId="1" PhysicalOp="Compute Scalar" LogicalOp="Compute Scalar" EstimateRows="3015.08" EstimateIO="0" EstimateCPU="0.000301508" AvgRowSize="59" EstimatedTotalSubtreeCost="1.26365" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Users]" Table="[DeliveryAddress]" Alias="[DA]" Column="City"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Users]" Table="[DeliveryAddress]" Alias="[DA]" Column="StateProvinceCode"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Defaults]" Table="[SaleTerritory]" Alias="[ST]" Column="SalesTerritoryRegion"></ColumnReference><ColumnReference Column="Expr1004"></ColumnReference></OutputList><ComputeScalar><DefinedValues><DefinedValue><ColumnReference Column="Expr1004"></ColumnReference><ScalarOperator ScalarString="CASE WHEN [globalagg1009]=(0) THEN NULL ELSE [globalagg1011] END"><IF><Condition><ScalarOperator><Compare CompareOp="EQ"><ScalarOperator><Identifier><ColumnReference Column="globalagg1009"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue="(0)"></Const></ScalarOperator></Compare></ScalarOperator></Condition><Then><ScalarOperator><Const ConstValue="NULL"></Const></ScalarOperator></Then><Else><ScalarOperator><Identifier><ColumnReference Column="globalagg1011"></ColumnReference></Identifier></ScalarOperator></Else></IF></ScalarOperator></DefinedValue></DefinedValues><RelOp NodeId="2" PhysicalOp="Stream Aggregate" LogicalOp="Aggregate" EstimateRows="3015.08" EstimateIO="0" EstimateCPU="0.00366214" AvgRowSize="67" EstimatedTotalSubtreeCost="1.26335" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Users]" Table="[DeliveryAddress]" Alias="[DA]" Column="City"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Users]" Table="[DeliveryAddress]" Alias="[DA]" Column="StateProvinceCode"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Defaults]" Table="[SaleTerritory]" Alias="[ST]" Column="SalesTerritoryRegion"></ColumnReference><ColumnReference Column="globalagg1009"></ColumnReference><ColumnReference Column="globalagg1011"></ColumnReference></OutputList><StreamAggregate><DefinedValues><DefinedValue><ColumnReference Column="globalagg1009"></ColumnReference><ScalarOperator ScalarString="SUM([partialagg1008])"><Aggregate Distinct="0" AggType="SUM"><ScalarOperator><Identifier><ColumnReference Column="partialagg1008"></ColumnReference></Identifier></ScalarOperator></Aggregate></ScalarOperator></DefinedValue><DefinedValue><ColumnReference Column="globalagg1011"></ColumnReference><ScalarOperator ScalarString="SUM([partialagg1010])"><Aggregate Distinct="0" AggType="SUM"><ScalarOperator><Identifier><ColumnReference Column="partialagg1010"></ColumnReference></Identifier></ScalarOperator></Aggregate></ScalarOperator></DefinedValue></DefinedValues><GroupBy><ColumnReference Database="[AdventureWorks]" Schema="[Users]" Table="[DeliveryAddress]" Alias="[DA]" Column="City"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Users]" Table="[DeliveryAddress]" Alias="[DA]" Column="StateProvinceCode"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Defaults]" Table="[SaleTerritory]" Alias="[ST]" Column="SalesTerritoryRegion"></ColumnReference></GroupBy><RelOp NodeId="3" PhysicalOp="Sort" LogicalOp="Sort" EstimateRows="3591" EstimateIO="0.0112613" EstimateCPU="0.0662602" AvgRowSize="67" EstimatedTotalSubtreeCost="1.25968" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Users]" Table="[DeliveryAddress]" Alias="[DA]" Column="City"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Users]" Table="[DeliveryAddress]" Alias="[DA]" Column="StateProvinceCode"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Defaults]" Table="[SaleTerritory]" Alias="[ST]" Column="SalesTerritoryRegion"></ColumnReference><ColumnReference Column="partialagg1008"></ColumnReference><ColumnReference Column="partialagg1010"></ColumnReference></OutputList><MemoryFractions Input="0.810127" Output="1"></MemoryFractions><Sort Distinct="0"><OrderBy><OrderByColumn Ascending="1"><ColumnReference Database="[AdventureWorks]" Schema="[Users]" Table="[DeliveryAddress]" Alias="[DA]" Column="City"></ColumnReference></OrderByColumn><OrderByColumn Ascending="1"><ColumnReference Database="[AdventureWorks]" Schema="[Users]" Table="[DeliveryAddress]" Alias="[DA]" Column="StateProvinceCode"></ColumnReference></OrderByColumn><OrderByColumn Ascending="1"><ColumnReference Database="[AdventureWorks]" Schema="[Defaults]" Table="[SaleTerritory]" Alias="[ST]" Column="SalesTerritoryRegion"></ColumnReference></OrderByColumn></OrderBy><RelOp NodeId="4" PhysicalOp="Hash Match" LogicalOp="Inner Join" EstimateRows="3591" EstimateIO="0" EstimateCPU="0.105142" AvgRowSize="67" EstimatedTotalSubtreeCost="1.18216" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Users]" Table="[DeliveryAddress]" Alias="[DA]" Column="City"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Users]" Table="[DeliveryAddress]" Alias="[DA]" Column="StateProvinceCode"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Defaults]" Table="[SaleTerritory]" Alias="[ST]" Column="SalesTerritoryRegion"></ColumnReference><ColumnReference Column="partialagg1008"></ColumnReference><ColumnReference Column="partialagg1010"></ColumnReference></OutputList><MemoryFractions Input="0.0840336" Output="0.189873"></MemoryFractions><Hash><DefinedValues></DefinedValues><HashKeysBuild><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[Sale]" Alias="[S]" Column="SaleTerritoryKey"></ColumnReference></HashKeysBuild><HashKeysProbe><ColumnReference Database="[AdventureWorks]" Schema="[Users]" Table="[DeliveryAddress]" Alias="[DA]" Column="SaleTerritoryKey"></ColumnReference></HashKeysProbe><RelOp NodeId="5" PhysicalOp="Hash Match" LogicalOp="Aggregate" EstimateRows="1" EstimateIO="0" EstimateCPU="0.121831" AvgRowSize="46" EstimatedTotalSubtreeCost="0.792661" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Defaults]" Table="[SaleTerritory]" Alias="[ST]" Column="SalesTerritoryRegion"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[Sale]" Alias="[S]" Column="SaleTerritoryKey"></ColumnReference><ColumnReference Column="partialagg1008"></ColumnReference><ColumnReference Column="partialagg1010"></ColumnReference></OutputList><MemoryFractions Input="0.59944" Output="0.915966"></MemoryFractions><Hash><DefinedValues><DefinedValue><ColumnReference Column="partialagg1008"></ColumnReference><ScalarOperator ScalarString="COUNT_BIG([AdventureWorks].[Orders].[OrderedProducts].[SalesAmount] as [OP].[SalesAmount])"><Aggregate Distinct="0" AggType="COUNT_BIG"><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]" Alias="[OP]" Column="SalesAmount"></ColumnReference></Identifier></ScalarOperator></Aggregate></ScalarOperator></DefinedValue><DefinedValue><ColumnReference Column="partialagg1010"></ColumnReference><ScalarOperator ScalarString="SUM([AdventureWorks].[Orders].[OrderedProducts].[SalesAmount] as [OP].[SalesAmount])"><Aggregate Distinct="0" AggType="SUM"><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]" Alias="[OP]" Column="SalesAmount"></ColumnReference></Identifier></ScalarOperator></Aggregate></ScalarOperator></DefinedValue><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[Defaults]" Table="[SaleTerritory]" Alias="[ST]" Column="SalesTerritoryRegion"></ColumnReference><ScalarOperator ScalarString="ANY([AdventureWorks].[Defaults].[SaleTerritory].[SalesTerritoryRegion] as [ST].[SalesTerritoryRegion])"><Aggregate Distinct="0" AggType="ANY"><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[Defaults]" Table="[SaleTerritory]" Alias="[ST]" Column="SalesTerritoryRegion"></ColumnReference></Identifier></ScalarOperator></Aggregate></ScalarOperator></DefinedValue></DefinedValues><HashKeysBuild><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[Sale]" Alias="[S]" Column="SaleTerritoryKey"></ColumnReference></HashKeysBuild><RelOp NodeId="6" PhysicalOp="Hash Match" LogicalOp="Inner Join" EstimateRows="22247" EstimateIO="0" EstimateCPU="0.13734" AvgRowSize="38" EstimatedTotalSubtreeCost="0.67083" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Defaults]" Table="[SaleTerritory]" Alias="[ST]" Column="SalesTerritoryRegion"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[Sale]" Alias="[S]" Column="SaleTerritoryKey"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]" Alias="[OP]" Column="SalesAmount"></ColumnReference></OutputList><MemoryFractions Input="0.104895" Output="0.0420168"></MemoryFractions><Hash><DefinedValues></DefinedValues><HashKeysBuild><ColumnReference Database="[AdventureWorks]" Schema="[Defaults]" Table="[SaleTerritory]" Alias="[ST]" Column="SaleTerritoryKey"></ColumnReference></HashKeysBuild><HashKeysProbe><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[Sale]" Alias="[S]" Column="SaleTerritoryKey"></ColumnReference></HashKeysProbe><RelOp NodeId="7" PhysicalOp="Clustered Index Scan" LogicalOp="Clustered Index Scan" EstimateRows="11" EstimatedRowsRead="11" EstimateIO="0.003125" EstimateCPU="0.0001691" AvgRowSize="30" EstimatedTotalSubtreeCost="0.0032941" TableCardinality="11" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Defaults]" Table="[SaleTerritory]" Alias="[ST]" Column="SaleTerritoryKey"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Defaults]" Table="[SaleTerritory]" Alias="[ST]" Column="SalesTerritoryRegion"></ColumnReference></OutputList><IndexScan Ordered="0" ForcedIndex="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[Defaults]" Table="[SaleTerritory]" Alias="[ST]" Column="SaleTerritoryKey"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[Defaults]" Table="[SaleTerritory]" Alias="[ST]" Column="SalesTerritoryRegion"></ColumnReference></DefinedValue></DefinedValues><Object Database="[AdventureWorks]" Schema="[Defaults]" Table="[SaleTerritory]" Index="[PK__SaleTerr__218AE9E059468BD8]" Alias="[ST]" IndexKind="Clustered" Storage="RowStore"></Object></IndexScan></RelOp><RelOp NodeId="8" PhysicalOp="Hash Match" LogicalOp="Inner Join" EstimateRows="22247" EstimateIO="0" EstimateCPU="0.239764" AvgRowSize="19" EstimatedTotalSubtreeCost="0.530193" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[Sale]" Alias="[S]" Column="SaleTerritoryKey"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]" Alias="[OP]" Column="SalesAmount"></ColumnReference></OutputList><MemoryFractions Input="0.895105" Output="0.358543"></MemoryFractions><Hash><DefinedValues></DefinedValues><HashKeysBuild><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[Sale]" Alias="[S]" Column="SaleKey"></ColumnReference></HashKeysBuild><HashKeysProbe><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]" Alias="[OP]" Column="SaleKey"></ColumnReference></HashKeysProbe><RelOp NodeId="9" PhysicalOp="Clustered Index Scan" LogicalOp="Clustered Index Scan" EstimateRows="8873" EstimatedRowsRead="8873" EstimateIO="0.0616435" EstimateCPU="0.0099173" AvgRowSize="15" EstimatedTotalSubtreeCost="0.0715608" TableCardinality="8873" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[Sale]" Alias="[S]" Column="SaleKey"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[Sale]" Alias="[S]" Column="SaleTerritoryKey"></ColumnReference></OutputList><IndexScan Ordered="0" ForcedIndex="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[Sale]" Alias="[S]" Column="SaleKey"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[Sale]" Alias="[S]" Column="SaleTerritoryKey"></ColumnReference></DefinedValue></DefinedValues><Object Database="[AdventureWorks]" Schema="[Orders]" Table="[Sale]" Index="[PK__Sale__1C32977D6843DCA0]" Alias="[S]" IndexKind="Clustered" Storage="RowStore"></Object></IndexScan></RelOp><RelOp NodeId="10" PhysicalOp="Clustered Index Scan" LogicalOp="Clustered Index Scan" EstimateRows="22247" EstimatedRowsRead="22247" EstimateIO="0.194236" EstimateCPU="0.0246287" AvgRowSize="19" EstimatedTotalSubtreeCost="0.218865" TableCardinality="22247" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]" Alias="[OP]" Column="SalesAmount"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]" Alias="[OP]" Column="SaleKey"></ColumnReference></OutputList><IndexScan Ordered="0" ForcedIndex="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]" Alias="[OP]" Column="SalesAmount"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]" Alias="[OP]" Column="SaleKey"></ColumnReference></DefinedValue></DefinedValues><Object Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]" Index="[PK__OrderedP__54F4D88AE796779F]" Alias="[OP]" IndexKind="Clustered" Storage="RowStore"></Object></IndexScan></RelOp></Hash></RelOp></Hash></RelOp></Hash></RelOp><RelOp NodeId="11" PhysicalOp="Clustered Index Scan" LogicalOp="Clustered Index Scan" EstimateRows="18484" EstimatedRowsRead="18484" EstimateIO="0.263866" EstimateCPU="0.0204894" AvgRowSize="38" EstimatedTotalSubtreeCost="0.284355" TableCardinality="18484" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Users]" Table="[DeliveryAddress]" Alias="[DA]" Column="City"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Users]" Table="[DeliveryAddress]" Alias="[DA]" Column="StateProvinceCode"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Users]" Table="[DeliveryAddress]" Alias="[DA]" Column="SaleTerritoryKey"></ColumnReference></OutputList><IndexScan Ordered="0" ForcedIndex="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[Users]" Table="[DeliveryAddress]" Alias="[DA]" Column="City"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[Users]" Table="[DeliveryAddress]" Alias="[DA]" Column="StateProvinceCode"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[Users]" Table="[DeliveryAddress]" Alias="[DA]" Column="SaleTerritoryKey"></ColumnReference></DefinedValue></DefinedValues><Object Database="[AdventureWorks]" Schema="[Users]" Table="[DeliveryAddress]" Index="[PK__Delivery__9BC085BD03AF3336]" Alias="[DA]" IndexKind="Clustered" Storage="RowStore"></Object></IndexScan></RelOp></Hash></RelOp></Sort></RelOp></StreamAggregate></RelOp></ComputeScalar></RelOp></QueryPlan></StmtSimple><StmtSimple StatementText=";&#xd;&#xa;&#xd;&#xa;/*&#xd;&#xa;Query growth rate&#xd;&#xa;*/&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;SELECT&#xd;&#xa;    YEAR(S1.OrderDate) AS Year,&#xd;&#xa;    PC.EnglishName AS Category,&#xd;&#xa;    SUM(OP1.SalesAmount) AS TotalSales,&#xd;&#xa;    (SUM(OP1.SalesAmount) - LAG(SUM(OP1.SalesAmount), 1, 0) OVER (PARTITION BY PC.CategoryKey ORDER BY YEAR(S1.OrderDate))) / &#xd;&#xa;        NULLIF(LAG(SUM(OP1.SalesAmount), 1, 1) OVER (PARTITION BY PC.CategoryKey ORDER BY YEAR(S1.OrderDate)), 0) AS GrowthRate&#xd;&#xa;FROM&#xd;&#xa;    Orders.Sale S1&#xd;&#xa;    JOIN Orders.OrderedProducts OP1 ON S1.SaleKey = OP1.SaleKey&#xd;&#xa;    JOIN Products.Product P ON OP1.ProductKey = P.ProductKey&#xd;&#xa;    JOIN Products.ProductCategory PC ON P.CategoryKey = PC.CategoryKey&#xd;&#xa;GROUP BY&#xd;&#xa;    YEAR(S1.OrderDate), PC.EnglishName, PC.CategoryKey" StatementId="14" StatementCompId="18" StatementType="SELECT" StatementSqlHandle="0x0900B18DFC4BE2071B84B8B960B8AE9FABAB0000000000000000000000000000000000000000000000000000" DatabaseContextSettingsId="1" ParentObjectId="0" StatementParameterizationType="0" RetrievedFromCache="true" StatementSubTreeCost="0.836751" StatementEstRows="49.7704" SecurityPolicyApplied="false" StatementOptmLevel="FULL" QueryHash="0xB8734A33B3F7891B" QueryPlanHash="0x9F8BBCDAFDB4CA35" StatementOptmEarlyAbortReason="TimeOut" CardinalityEstimationModelVersion="160"><StatementSetOptions QUOTED_IDENTIFIER="true" ARITHABORT="true" CONCAT_NULL_YIELDS_NULL="true" ANSI_NULLS="true" ANSI_PADDING="true" ANSI_WARNINGS="true" NUMERIC_ROUNDABORT="false"></StatementSetOptions><QueryPlan CachedPlanSize="152" CompileTime="8" CompileCPU="8" CompileMemory="1008"><MissingIndexes><MissingIndexGroup Impact="43.9069"><MissingIndex Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]"><ColumnGroup Usage="EQUALITY"><Column Name="[ProductKey]" ColumnId="12"></Column></ColumnGroup><ColumnGroup Usage="INCLUDE"><Column Name="[SalesAmount]" ColumnId="5"></Column><Column Name="[SaleKey]" ColumnId="11"></Column></ColumnGroup></MissingIndex></MissingIndexGroup></MissingIndexes><MemoryGrantInfo SerialRequiredMemory="3072" SerialDesiredMemory="5312" GrantedMemory="0" MaxUsedMemory="0"></MemoryGrantInfo><OptimizerHardwareDependentProperties EstimatedAvailableMemoryGrant="40281" EstimatedPagesCached="20140" EstimatedAvailableDegreeOfParallelism="4" MaxCompileMemory="1315768"></OptimizerHardwareDependentProperties><OptimizerStatsUsage><StatisticsInfo LastUpdate="2024-01-20T23:18:16.59" ModificationCount="0" SamplingPercent="100" Statistics="[_WA_Sys_0000000C_628FA481]" Table="[OrderedProducts]" Schema="[Orders]" Database="[AdventureWorks]"></StatisticsInfo><StatisticsInfo LastUpdate="2024-01-20T23:17:58.64" ModificationCount="0" SamplingPercent="100" Statistics="[PK__Sale__1C32977D6843DCA0]" Table="[Sale]" Schema="[Orders]" Database="[AdventureWorks]"></StatisticsInfo><StatisticsInfo LastUpdate="2024-01-20T23:18:16.60" ModificationCount="0" SamplingPercent="100" Statistics="[PK__Product__A15E99B36D34A312]" Table="[Product]" Schema="[Products]" Database="[AdventureWorks]"></StatisticsInfo><StatisticsInfo LastUpdate="2024-01-21T01:14:19.28" ModificationCount="0" SamplingPercent="100" Statistics="[idx_CategoryKey]" Table="[Product]" Schema="[Products]" Database="[AdventureWorks]"></StatisticsInfo><StatisticsInfo LastUpdate="2024-01-20T23:17:58.67" ModificationCount="0" SamplingPercent="100" Statistics="[_WA_Sys_0000000B_628FA481]" Table="[OrderedProducts]" Schema="[Orders]" Database="[AdventureWorks]"></StatisticsInfo><StatisticsInfo LastUpdate="2024-01-20T23:18:16.62" ModificationCount="0" SamplingPercent="100" Statistics="[_WA_Sys_00000007_5441852A]" Table="[Sale]" Schema="[Orders]" Database="[AdventureWorks]"></StatisticsInfo><StatisticsInfo LastUpdate="2024-01-20T23:18:16.61" ModificationCount="0" SamplingPercent="100" Statistics="[PK__ProductC__76B0FE41711E1E4C]" Table="[ProductCategory]" Schema="[Products]" Database="[AdventureWorks]"></StatisticsInfo><StatisticsInfo LastUpdate="2024-01-20T23:18:16.60" ModificationCount="0" SamplingPercent="100" Statistics="[_WA_Sys_00000012_5DCAEF64]" Table="[Product]" Schema="[Products]" Database="[AdventureWorks]"></StatisticsInfo></OptimizerStatsUsage><RelOp NodeId="0" PhysicalOp="Compute Scalar" LogicalOp="Compute Scalar" EstimateRows="49.7704" EstimateIO="0" EstimateCPU="4.97704e-06" AvgRowSize="95" EstimatedTotalSubtreeCost="0.836751" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="EnglishName"></ColumnReference><ColumnReference Column="Expr1004"></ColumnReference><ColumnReference Column="Expr1005"></ColumnReference><ColumnReference Column="Expr1009"></ColumnReference></OutputList><ComputeScalar><DefinedValues><DefinedValue><ColumnReference Column="Expr1009"></ColumnReference><ScalarOperator ScalarString="([Expr1005]-[Expr1006])/CASE WHEN [Expr1007]=(0.0000000000000000e+000) THEN NULL ELSE [Expr1008] END"><Arithmetic Operation="DIV"><ScalarOperator><Arithmetic Operation="SUB"><ScalarOperator><Identifier><ColumnReference Column="Expr1005"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Identifier><ColumnReference Column="Expr1006"></ColumnReference></Identifier></ScalarOperator></Arithmetic></ScalarOperator><ScalarOperator><IF><Condition><ScalarOperator><Compare CompareOp="EQ"><ScalarOperator><Identifier><ColumnReference Column="Expr1007"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue="(0.0000000000000000e+000)"></Const></ScalarOperator></Compare></ScalarOperator></Condition><Then><ScalarOperator><Const ConstValue="NULL"></Const></ScalarOperator></Then><Else><ScalarOperator><Identifier><ColumnReference Column="Expr1008"></ColumnReference></Identifier></ScalarOperator></Else></IF></ScalarOperator></Arithmetic></ScalarOperator></DefinedValue></DefinedValues><RelOp NodeId="1" PhysicalOp="Compute Scalar" LogicalOp="Compute Scalar" EstimateRows="49.7704" EstimateIO="0" EstimateCPU="4.97704e-06" AvgRowSize="111" EstimatedTotalSubtreeCost="0.836746" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="EnglishName"></ColumnReference><ColumnReference Column="Expr1004"></ColumnReference><ColumnReference Column="Expr1005"></ColumnReference><ColumnReference Column="Expr1006"></ColumnReference><ColumnReference Column="Expr1007"></ColumnReference><ColumnReference Column="Expr1008"></ColumnReference></OutputList><ComputeScalar><DefinedValues><DefinedValue><ColumnReference Column="Expr1006"></ColumnReference><ScalarOperator ScalarString="CASE WHEN [Count1011]=(0) THEN (0.0000000000000000e+000) ELSE [LastValue1010] END"><IF><Condition><ScalarOperator><Compare CompareOp="EQ"><ScalarOperator><Identifier><ColumnReference Column="Count1011"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue="(0)"></Const></ScalarOperator></Compare></ScalarOperator></Condition><Then><ScalarOperator><Const ConstValue="(0.0000000000000000e+000)"></Const></ScalarOperator></Then><Else><ScalarOperator><Identifier><ColumnReference Column="LastValue1010"></ColumnReference></Identifier></ScalarOperator></Else></IF></ScalarOperator></DefinedValue><DefinedValue><ColumnReference Column="Expr1007"></ColumnReference><ScalarOperator ScalarString="CASE WHEN [Count1013]=(0) THEN (1.0000000000000000e+000) ELSE [LastValue1012] END"><IF><Condition><ScalarOperator><Compare CompareOp="EQ"><ScalarOperator><Identifier><ColumnReference Column="Count1013"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue="(0)"></Const></ScalarOperator></Compare></ScalarOperator></Condition><Then><ScalarOperator><Const ConstValue="(1.0000000000000000e+000)"></Const></ScalarOperator></Then><Else><ScalarOperator><Identifier><ColumnReference Column="LastValue1012"></ColumnReference></Identifier></ScalarOperator></Else></IF></ScalarOperator></DefinedValue><DefinedValue><ColumnReference Column="Expr1008"></ColumnReference><ScalarOperator ScalarString="CASE WHEN [Count1015]=(0) THEN (1.0000000000000000e+000) ELSE [LastValue1014] END"><IF><Condition><ScalarOperator><Compare CompareOp="EQ"><ScalarOperator><Identifier><ColumnReference Column="Count1015"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue="(0)"></Const></ScalarOperator></Compare></ScalarOperator></Condition><Then><ScalarOperator><Const ConstValue="(1.0000000000000000e+000)"></Const></ScalarOperator></Then><Else><ScalarOperator><Identifier><ColumnReference Column="LastValue1014"></ColumnReference></Identifier></ScalarOperator></Else></IF></ScalarOperator></DefinedValue></DefinedValues><RelOp NodeId="2" PhysicalOp="Compute Scalar" LogicalOp="Compute Scalar" EstimateRows="49.7704" EstimateIO="0" EstimateCPU="0" AvgRowSize="123" EstimatedTotalSubtreeCost="0.836741" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="EnglishName"></ColumnReference><ColumnReference Column="Expr1004"></ColumnReference><ColumnReference Column="Expr1005"></ColumnReference><ColumnReference Column="LastValue1010"></ColumnReference><ColumnReference Column="Count1011"></ColumnReference><ColumnReference Column="LastValue1012"></ColumnReference><ColumnReference Column="Count1013"></ColumnReference><ColumnReference Column="LastValue1014"></ColumnReference><ColumnReference Column="Count1015"></ColumnReference></OutputList><ComputeScalar><DefinedValues><DefinedValue><ColumnReference Column="LastValue1012"></ColumnReference><ScalarOperator ScalarString="[LastValue1010]"><Identifier><ColumnReference Column="LastValue1010"></ColumnReference></Identifier></ScalarOperator></DefinedValue><DefinedValue><ColumnReference Column="Count1013"></ColumnReference><ScalarOperator ScalarString="[Count1011]"><Identifier><ColumnReference Column="Count1011"></ColumnReference></Identifier></ScalarOperator></DefinedValue><DefinedValue><ColumnReference Column="LastValue1014"></ColumnReference><ScalarOperator ScalarString="[LastValue1010]"><Identifier><ColumnReference Column="LastValue1010"></ColumnReference></Identifier></ScalarOperator></DefinedValue><DefinedValue><ColumnReference Column="Count1015"></ColumnReference><ScalarOperator ScalarString="[Count1011]"><Identifier><ColumnReference Column="Count1011"></ColumnReference></Identifier></ScalarOperator></DefinedValue></DefinedValues><RelOp NodeId="3" PhysicalOp="Stream Aggregate" LogicalOp="Aggregate" EstimateRows="49.7704" EstimateIO="0" EstimateCPU="3.12558e-05" AvgRowSize="123" EstimatedTotalSubtreeCost="0.836741" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="EnglishName"></ColumnReference><ColumnReference Column="Expr1004"></ColumnReference><ColumnReference Column="Expr1005"></ColumnReference><ColumnReference Column="LastValue1010"></ColumnReference><ColumnReference Column="Count1011"></ColumnReference></OutputList><StreamAggregate><DefinedValues><DefinedValue><ColumnReference Column="Count1011"></ColumnReference><ScalarOperator ScalarString="Count(*)"><Aggregate AggType="countstar" Distinct="0"></Aggregate></ScalarOperator></DefinedValue><DefinedValue><ColumnReference Column="LastValue1010"></ColumnReference><ScalarOperator ScalarString="LAST_VALUE([Expr1005])"><Aggregate Distinct="0" AggType="LAST_VALUE"><ScalarOperator><Identifier><ColumnReference Column="Expr1005"></ColumnReference></Identifier></ScalarOperator></Aggregate></ScalarOperator></DefinedValue><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="EnglishName"></ColumnReference><ScalarOperator ScalarString="ANY([AdventureWorks].[Products].[ProductCategory].[EnglishName] as [PC].[EnglishName])"><Aggregate Distinct="0" AggType="ANY"><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="EnglishName"></ColumnReference></Identifier></ScalarOperator></Aggregate></ScalarOperator></DefinedValue><DefinedValue><ColumnReference Column="Expr1004"></ColumnReference><ScalarOperator ScalarString="ANY([Expr1004])"><Aggregate Distinct="0" AggType="ANY"><ScalarOperator><Identifier><ColumnReference Column="Expr1004"></ColumnReference></Identifier></ScalarOperator></Aggregate></ScalarOperator></DefinedValue><DefinedValue><ColumnReference Column="Expr1005"></ColumnReference><ScalarOperator ScalarString="ANY([Expr1005])"><Aggregate Distinct="0" AggType="ANY"><ScalarOperator><Identifier><ColumnReference Column="Expr1005"></ColumnReference></Identifier></ScalarOperator></Aggregate></ScalarOperator></DefinedValue></DefinedValues><GroupBy><ColumnReference Column="WindowCount1027"></ColumnReference></GroupBy><RelOp NodeId="4" PhysicalOp="Window Spool" LogicalOp="Window Spool" EstimateRows="99.5408" EstimateIO="0" EstimateCPU="0.000109395" AvgRowSize="123" EstimatedTotalSubtreeCost="0.83671" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="CategoryKey"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="EnglishName"></ColumnReference><ColumnReference Column="Expr1004"></ColumnReference><ColumnReference Column="Expr1005"></ColumnReference><ColumnReference Column="RowNumber1016"></ColumnReference><ColumnReference Column="WindowCount1027"></ColumnReference><ColumnReference Column="Segment1026"></ColumnReference></OutputList><WindowSpool><RelOp NodeId="5" PhysicalOp="Segment" LogicalOp="Segment" EstimateRows="49.7704" EstimateIO="0" EstimateCPU="3.12558e-06" AvgRowSize="123" EstimatedTotalSubtreeCost="0.836588" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="CategoryKey"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="EnglishName"></ColumnReference><ColumnReference Column="Expr1004"></ColumnReference><ColumnReference Column="Expr1005"></ColumnReference><ColumnReference Column="RowNumber1016"></ColumnReference><ColumnReference Column="TopRowNumber1017"></ColumnReference><ColumnReference Column="BottomRowNumber1018"></ColumnReference><ColumnReference Column="Segment1026"></ColumnReference></OutputList><Segment><GroupBy><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="CategoryKey"></ColumnReference></GroupBy><SegmentColumn><ColumnReference Column="Segment1026"></ColumnReference></SegmentColumn><RelOp NodeId="6" PhysicalOp="Compute Scalar" LogicalOp="Compute Scalar" EstimateRows="49.7704" EstimateIO="0" EstimateCPU="4.97704e-06" AvgRowSize="115" EstimatedTotalSubtreeCost="0.836585" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="CategoryKey"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="EnglishName"></ColumnReference><ColumnReference Column="Expr1004"></ColumnReference><ColumnReference Column="Expr1005"></ColumnReference><ColumnReference Column="RowNumber1016"></ColumnReference><ColumnReference Column="TopRowNumber1017"></ColumnReference><ColumnReference Column="BottomRowNumber1018"></ColumnReference></OutputList><ComputeScalar><DefinedValues><DefinedValue><ColumnReference Column="TopRowNumber1017"></ColumnReference><ScalarOperator ScalarString="[RowNumber1016]-(1)"><Arithmetic Operation="SUB"><ScalarOperator><Identifier><ColumnReference Column="RowNumber1016"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue="(1)"></Const></ScalarOperator></Arithmetic></ScalarOperator></DefinedValue><DefinedValue><ColumnReference Column="BottomRowNumber1018"></ColumnReference><ScalarOperator ScalarString="[RowNumber1016]-(1)"><Arithmetic Operation="SUB"><ScalarOperator><Identifier><ColumnReference Column="RowNumber1016"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue="(1)"></Const></ScalarOperator></Arithmetic></ScalarOperator></DefinedValue></DefinedValues><RelOp NodeId="7" PhysicalOp="Sequence Project" LogicalOp="Compute Scalar" EstimateRows="49.7704" EstimateIO="0" EstimateCPU="3.98163e-06" AvgRowSize="99" EstimatedTotalSubtreeCost="0.83658" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="CategoryKey"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="EnglishName"></ColumnReference><ColumnReference Column="Expr1004"></ColumnReference><ColumnReference Column="Expr1005"></ColumnReference><ColumnReference Column="RowNumber1016"></ColumnReference></OutputList><SequenceProject><DefinedValues><DefinedValue><ColumnReference Column="RowNumber1016"></ColumnReference><ScalarOperator ScalarString="row_number"><Sequence FunctionName="row_number"></Sequence></ScalarOperator></DefinedValue></DefinedValues><RelOp NodeId="8" PhysicalOp="Segment" LogicalOp="Segment" EstimateRows="49.7704" EstimateIO="0" EstimateCPU="9.95408e-07" AvgRowSize="99" EstimatedTotalSubtreeCost="0.836576" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="CategoryKey"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="EnglishName"></ColumnReference><ColumnReference Column="Expr1004"></ColumnReference><ColumnReference Column="Expr1005"></ColumnReference><ColumnReference Column="Segment1025"></ColumnReference></OutputList><Segment><GroupBy><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="CategoryKey"></ColumnReference></GroupBy><SegmentColumn><ColumnReference Column="Segment1025"></ColumnReference></SegmentColumn><RelOp NodeId="9" PhysicalOp="Sort" LogicalOp="Sort" EstimateRows="49.7704" EstimateIO="0.0112613" EstimateCPU="0.000537775" AvgRowSize="91" EstimatedTotalSubtreeCost="0.836575" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="CategoryKey"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="EnglishName"></ColumnReference><ColumnReference Column="Expr1004"></ColumnReference><ColumnReference Column="Expr1005"></ColumnReference></OutputList><MemoryFractions Input="0.584475" Output="1"></MemoryFractions><Sort Distinct="0"><OrderBy><OrderByColumn Ascending="1"><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="CategoryKey"></ColumnReference></OrderByColumn><OrderByColumn Ascending="1"><ColumnReference Column="Expr1004"></ColumnReference></OrderByColumn></OrderBy><RelOp NodeId="10" PhysicalOp="Compute Scalar" LogicalOp="Compute Scalar" EstimateRows="49.7704" EstimateIO="0" EstimateCPU="0" AvgRowSize="91" EstimatedTotalSubtreeCost="0.824776" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="CategoryKey"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="EnglishName"></ColumnReference><ColumnReference Column="Expr1004"></ColumnReference><ColumnReference Column="Expr1005"></ColumnReference></OutputList><ComputeScalar><DefinedValues><DefinedValue><ColumnReference Column="Expr1005"></ColumnReference><ScalarOperator ScalarString="CASE WHEN [Expr1023]=(0) THEN NULL ELSE [Expr1024] END"><IF><Condition><ScalarOperator><Compare CompareOp="EQ"><ScalarOperator><Identifier><ColumnReference Column="Expr1023"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Const ConstValue="(0)"></Const></ScalarOperator></Compare></ScalarOperator></Condition><Then><ScalarOperator><Const ConstValue="NULL"></Const></ScalarOperator></Then><Else><ScalarOperator><Identifier><ColumnReference Column="Expr1024"></ColumnReference></Identifier></ScalarOperator></Else></IF></ScalarOperator></DefinedValue></DefinedValues><RelOp NodeId="11" PhysicalOp="Hash Match" LogicalOp="Aggregate" EstimateRows="49.7704" EstimateIO="0" EstimateCPU="0.169864" AvgRowSize="91" EstimatedTotalSubtreeCost="0.824776" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="CategoryKey"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="EnglishName"></ColumnReference><ColumnReference Column="Expr1004"></ColumnReference><ColumnReference Column="Expr1023"></ColumnReference><ColumnReference Column="Expr1024"></ColumnReference></OutputList><MemoryFractions Input="0.325" Output="0.415525"></MemoryFractions><Hash><DefinedValues><DefinedValue><ColumnReference Column="Expr1023"></ColumnReference><ScalarOperator ScalarString="COUNT_BIG([AdventureWorks].[Orders].[OrderedProducts].[SalesAmount] as [OP1].[SalesAmount])"><Aggregate Distinct="0" AggType="COUNT_BIG"><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]" Alias="[OP1]" Column="SalesAmount"></ColumnReference></Identifier></ScalarOperator></Aggregate></ScalarOperator></DefinedValue><DefinedValue><ColumnReference Column="Expr1024"></ColumnReference><ScalarOperator ScalarString="SUM([AdventureWorks].[Orders].[OrderedProducts].[SalesAmount] as [OP1].[SalesAmount])"><Aggregate Distinct="0" AggType="SUM"><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]" Alias="[OP1]" Column="SalesAmount"></ColumnReference></Identifier></ScalarOperator></Aggregate></ScalarOperator></DefinedValue><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="EnglishName"></ColumnReference><ScalarOperator ScalarString="ANY([AdventureWorks].[Products].[ProductCategory].[EnglishName] as [PC].[EnglishName])"><Aggregate Distinct="0" AggType="ANY"><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="EnglishName"></ColumnReference></Identifier></ScalarOperator></Aggregate></ScalarOperator></DefinedValue></DefinedValues><HashKeysBuild><ColumnReference Column="Expr1004"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="CategoryKey"></ColumnReference></HashKeysBuild><BuildResidual><ScalarOperator ScalarString="[Expr1004] = [Expr1004] AND [AdventureWorks].[Products].[ProductCategory].[CategoryKey] as [PC].[CategoryKey] = [AdventureWorks].[Products].[ProductCategory].[CategoryKey] as [PC].[CategoryKey]"><Logical Operation="AND"><ScalarOperator><Compare CompareOp="IS"><ScalarOperator><Identifier><ColumnReference Column="Expr1004"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Identifier><ColumnReference Column="Expr1004"></ColumnReference></Identifier></ScalarOperator></Compare></ScalarOperator><ScalarOperator><Compare CompareOp="IS"><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="CategoryKey"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="CategoryKey"></ColumnReference></Identifier></ScalarOperator></Compare></ScalarOperator></Logical></ScalarOperator></BuildResidual><RelOp NodeId="12" PhysicalOp="Hash Match" LogicalOp="Inner Join" EstimateRows="22247" EstimateIO="0" EstimateCPU="0.239764" AvgRowSize="91" EstimatedTotalSubtreeCost="0.654912" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]" Alias="[OP1]" Column="SalesAmount"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="CategoryKey"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="EnglishName"></ColumnReference><ColumnReference Column="Expr1004"></ColumnReference></OutputList><MemoryFractions Input="0.677249" Output="0.457143"></MemoryFractions><Hash><DefinedValues></DefinedValues><HashKeysBuild><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[Sale]" Alias="[S1]" Column="SaleKey"></ColumnReference></HashKeysBuild><HashKeysProbe><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]" Alias="[OP1]" Column="SaleKey"></ColumnReference></HashKeysProbe><RelOp NodeId="13" PhysicalOp="Compute Scalar" LogicalOp="Compute Scalar" EstimateRows="8873" EstimateIO="0" EstimateCPU="0.0008873" AvgRowSize="15" EstimatedTotalSubtreeCost="0.0280037" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[Sale]" Alias="[S1]" Column="SaleKey"></ColumnReference><ColumnReference Column="Expr1004"></ColumnReference></OutputList><ComputeScalar><DefinedValues><DefinedValue><ColumnReference Column="Expr1004"></ColumnReference><ScalarOperator ScalarString="datepart(year,[AdventureWorks].[Orders].[Sale].[OrderDate] as [S1].[OrderDate])"><Intrinsic FunctionName="datepart"><ScalarOperator><Const ConstValue="(0)"></Const></ScalarOperator><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[Sale]" Alias="[S1]" Column="OrderDate"></ColumnReference></Identifier></ScalarOperator></Intrinsic></ScalarOperator></DefinedValue></DefinedValues><RelOp NodeId="14" PhysicalOp="Index Scan" LogicalOp="Index Scan" EstimateRows="8873" EstimatedRowsRead="8873" EstimateIO="0.0171991" EstimateCPU="0.0099173" AvgRowSize="19" EstimatedTotalSubtreeCost="0.0271164" TableCardinality="8873" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[Sale]" Alias="[S1]" Column="SaleKey"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[Sale]" Alias="[S1]" Column="OrderDate"></ColumnReference></OutputList><IndexScan Ordered="0" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[Sale]" Alias="[S1]" Column="SaleKey"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[Sale]" Alias="[S1]" Column="OrderDate"></ColumnReference></DefinedValue></DefinedValues><Object Database="[AdventureWorks]" Schema="[Orders]" Table="[Sale]" Index="[idx_OrderDate]" Alias="[S1]" IndexKind="NonClustered" Storage="RowStore"></Object></IndexScan></RelOp></ComputeScalar></RelOp><RelOp NodeId="15" PhysicalOp="Hash Match" LogicalOp="Inner Join" EstimateRows="22247" EstimateIO="0" EstimateCPU="0.15313" AvgRowSize="91" EstimatedTotalSubtreeCost="0.387141" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]" Alias="[OP1]" Column="SalesAmount"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]" Alias="[OP1]" Column="SaleKey"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="CategoryKey"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="EnglishName"></ColumnReference></OutputList><MemoryFractions Input="0.322751" Output="0.217857"></MemoryFractions><Hash><DefinedValues></DefinedValues><HashKeysBuild><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[Product]" Alias="[P]" Column="ProductKey"></ColumnReference></HashKeysBuild><HashKeysProbe><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]" Alias="[OP1]" Column="ProductKey"></ColumnReference></HashKeysProbe><RelOp NodeId="16" PhysicalOp="Nested Loops" LogicalOp="Inner Join" EstimateRows="397" EstimateIO="0" EstimateCPU="0.00165946" AvgRowSize="83" EstimatedTotalSubtreeCost="0.0151434" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[Product]" Alias="[P]" Column="ProductKey"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="CategoryKey"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="EnglishName"></ColumnReference></OutputList><NestedLoops Optimized="0" WithUnorderedPrefetch="1"><OuterReferences><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="CategoryKey"></ColumnReference><ColumnReference Column="Expr1022"></ColumnReference></OuterReferences><RelOp NodeId="18" PhysicalOp="Clustered Index Scan" LogicalOp="Clustered Index Scan" EstimateRows="42" EstimatedRowsRead="42" EstimateIO="0.003125" EstimateCPU="0.0002032" AvgRowSize="79" EstimatedTotalSubtreeCost="0.0033282" TableCardinality="42" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="CategoryKey"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="EnglishName"></ColumnReference></OutputList><IndexScan Ordered="0" ForcedIndex="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="CategoryKey"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="EnglishName"></ColumnReference></DefinedValue></DefinedValues><Object Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Index="[PK__ProductC__76B0FE41711E1E4C]" Alias="[PC]" IndexKind="Clustered" Storage="RowStore"></Object></IndexScan></RelOp><RelOp NodeId="19" PhysicalOp="Index Seek" LogicalOp="Index Seek" EstimateRows="9.45238" EstimatedRowsRead="9.45238" EstimateIO="0.003125" EstimateCPU="0.000167398" AvgRowSize="11" EstimatedTotalSubtreeCost="0.0101557" TableCardinality="397" Parallel="0" EstimateRebinds="41" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[Product]" Alias="[P]" Column="ProductKey"></ColumnReference></OutputList><IndexScan Ordered="1" ScanDirection="FORWARD" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[Product]" Alias="[P]" Column="ProductKey"></ColumnReference></DefinedValue></DefinedValues><Object Database="[AdventureWorks]" Schema="[Products]" Table="[Product]" Index="[idx_CategoryKey]" Alias="[P]" IndexKind="NonClustered" Storage="RowStore"></Object><SeekPredicates><SeekPredicateNew><SeekKeys><Prefix ScanType="EQ"><RangeColumns><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[Product]" Alias="[P]" Column="CategoryKey"></ColumnReference></RangeColumns><RangeExpressions><ScalarOperator ScalarString="[AdventureWorks].[Products].[ProductCategory].[CategoryKey] as [PC].[CategoryKey]"><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductCategory]" Alias="[PC]" Column="CategoryKey"></ColumnReference></Identifier></ScalarOperator></RangeExpressions></Prefix></SeekKeys></SeekPredicateNew></SeekPredicates></IndexScan></RelOp></NestedLoops></RelOp><RelOp NodeId="20" PhysicalOp="Clustered Index Scan" LogicalOp="Clustered Index Scan" EstimateRows="22247" EstimatedRowsRead="22247" EstimateIO="0.194236" EstimateCPU="0.0246287" AvgRowSize="23" EstimatedTotalSubtreeCost="0.218865" TableCardinality="22247" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]" Alias="[OP1]" Column="SalesAmount"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]" Alias="[OP1]" Column="SaleKey"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]" Alias="[OP1]" Column="ProductKey"></ColumnReference></OutputList><IndexScan Ordered="0" ForcedIndex="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]" Alias="[OP1]" Column="SalesAmount"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]" Alias="[OP1]" Column="SaleKey"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]" Alias="[OP1]" Column="ProductKey"></ColumnReference></DefinedValue></DefinedValues><Object Database="[AdventureWorks]" Schema="[Orders]" Table="[OrderedProducts]" Index="[PK__OrderedP__54F4D88AE796779F]" Alias="[OP1]" IndexKind="Clustered" Storage="RowStore"></Object></IndexScan></RelOp></Hash></RelOp></Hash></RelOp></Hash></RelOp></ComputeScalar></RelOp></Sort></RelOp></Segment></RelOp></SequenceProject></RelOp></ComputeScalar></RelOp></Segment></RelOp></WindowSpool></RelOp></StreamAggregate></RelOp></ComputeScalar></RelOp></ComputeScalar></RelOp></ComputeScalar></RelOp></QueryPlan></StmtSimple><StmtSimple StatementText=";&#xd;&#xa;&#xd;&#xa;/*&#xd;&#xa;Query color&#xd;&#xa;*/&#xd;&#xa;&#xd;&#xa;SELECT&#xd;&#xa;    PM.Color,&#xd;&#xa;    COUNT(P.ProductKey) AS NumberOfProducts&#xd;&#xa;FROM&#xd;&#xa;    Products.Product P&#xd;&#xa;    JOIN Products.ProductModel PM ON P.ModelKey = PM.ModelKey&#xd;&#xa;GROUP BY&#xd;&#xa;    PM.Color" StatementId="15" StatementCompId="19" StatementType="SELECT" StatementSqlHandle="0x09006355E6BB11059B7C8A54EFE2479896660000000000000000000000000000000000000000000000000000" DatabaseContextSettingsId="1" ParentObjectId="0" StatementParameterizationType="0" RetrievedFromCache="true" StatementSubTreeCost="0.0757199" StatementEstRows="10.9853" SecurityPolicyApplied="false" StatementOptmLevel="FULL" QueryHash="0x64CAD6862E543A35" QueryPlanHash="0x3EE719D747F2F1CE" StatementOptmEarlyAbortReason="GoodEnoughPlanFound" CardinalityEstimationModelVersion="160"><StatementSetOptions QUOTED_IDENTIFIER="true" ARITHABORT="true" CONCAT_NULL_YIELDS_NULL="true" ANSI_NULLS="true" ANSI_PADDING="true" ANSI_WARNINGS="true" NUMERIC_ROUNDABORT="false"></StatementSetOptions><QueryPlan CachedPlanSize="32" CompileTime="3" CompileCPU="2" CompileMemory="320"><MemoryGrantInfo SerialRequiredMemory="1024" SerialDesiredMemory="1120" GrantedMemory="0" MaxUsedMemory="0"></MemoryGrantInfo><OptimizerHardwareDependentProperties EstimatedAvailableMemoryGrant="40281" EstimatedPagesCached="20140" EstimatedAvailableDegreeOfParallelism="4" MaxCompileMemory="1315768"></OptimizerHardwareDependentProperties><OptimizerStatsUsage><StatisticsInfo LastUpdate="2024-01-21T01:14:19.28" ModificationCount="0" SamplingPercent="100" Statistics="[idx_CategoryKey]" Table="[Product]" Schema="[Products]" Database="[AdventureWorks]"></StatisticsInfo><StatisticsInfo LastUpdate="2024-01-20T22:52:51.67" ModificationCount="0" SamplingPercent="100" Statistics="[PK__ProductM__FB68A01A83174928]" Table="[ProductModel]" Schema="[Products]" Database="[AdventureWorks]"></StatisticsInfo><StatisticsInfo LastUpdate="2024-01-20T22:52:51.68" ModificationCount="0" SamplingPercent="100" Statistics="[_WA_Sys_00000003_5812160E]" Table="[ProductModel]" Schema="[Products]" Database="[AdventureWorks]"></StatisticsInfo><StatisticsInfo LastUpdate="2024-01-21T01:14:19.27" ModificationCount="0" SamplingPercent="100" Statistics="[idx_Color]" Table="[ProductModel]" Schema="[Products]" Database="[AdventureWorks]"></StatisticsInfo><StatisticsInfo LastUpdate="2024-01-20T22:52:51.66" ModificationCount="0" SamplingPercent="100" Statistics="[_WA_Sys_00000011_5DCAEF64]" Table="[Product]" Schema="[Products]" Database="[AdventureWorks]"></StatisticsInfo></OptimizerStatsUsage><RelOp NodeId="0" PhysicalOp="Compute Scalar" LogicalOp="Compute Scalar" EstimateRows="10.9853" EstimateIO="0" EstimateCPU="0" AvgRowSize="23" EstimatedTotalSubtreeCost="0.0757199" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductModel]" Alias="[PM]" Column="Color"></ColumnReference><ColumnReference Column="Expr1002"></ColumnReference></OutputList><ComputeScalar><DefinedValues><DefinedValue><ColumnReference Column="Expr1002"></ColumnReference><ScalarOperator ScalarString="CONVERT_IMPLICIT(int,[Expr1005],0)"><Convert DataType="int" Style="0" Implicit="1"><ScalarOperator><Identifier><ColumnReference Column="Expr1005"></ColumnReference></Identifier></ScalarOperator></Convert></ScalarOperator></DefinedValue></DefinedValues><RelOp NodeId="1" PhysicalOp="Stream Aggregate" LogicalOp="Aggregate" EstimateRows="10.9853" EstimateIO="0" EstimateCPU="0.000243693" AvgRowSize="23" EstimatedTotalSubtreeCost="0.0757199" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductModel]" Alias="[PM]" Column="Color"></ColumnReference><ColumnReference Column="Expr1005"></ColumnReference></OutputList><StreamAggregate><DefinedValues><DefinedValue><ColumnReference Column="Expr1005"></ColumnReference><ScalarOperator ScalarString="Count(*)"><Aggregate AggType="countstar" Distinct="0"></Aggregate></ScalarOperator></DefinedValue></DefinedValues><GroupBy><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductModel]" Alias="[PM]" Column="Color"></ColumnReference></GroupBy><RelOp NodeId="2" PhysicalOp="Sort" LogicalOp="Sort" EstimateRows="397" EstimateIO="0.0112613" EstimateCPU="0.00544661" AvgRowSize="19" EstimatedTotalSubtreeCost="0.0754762" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductModel]" Alias="[PM]" Column="Color"></ColumnReference></OutputList><MemoryFractions Input="0.5" Output="1"></MemoryFractions><Sort Distinct="0"><OrderBy><OrderByColumn Ascending="1"><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductModel]" Alias="[PM]" Column="Color"></ColumnReference></OrderByColumn></OrderBy><RelOp NodeId="3" PhysicalOp="Merge Join" LogicalOp="Inner Join" EstimateRows="397" EstimateIO="0" EstimateCPU="0.006759" AvgRowSize="19" EstimatedTotalSubtreeCost="0.0587683" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductModel]" Alias="[PM]" Column="Color"></ColumnReference></OutputList><Merge ManyToMany="0"><InnerSideJoinColumns><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[Product]" Alias="[P]" Column="ModelKey"></ColumnReference></InnerSideJoinColumns><OuterSideJoinColumns><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductModel]" Alias="[PM]" Column="ModelKey"></ColumnReference></OuterSideJoinColumns><Residual><ScalarOperator ScalarString="[AdventureWorks].[Products].[ProductModel].[ModelKey] as [PM].[ModelKey]=[AdventureWorks].[Products].[Product].[ModelKey] as [P].[ModelKey]"><Compare CompareOp="EQ"><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductModel]" Alias="[PM]" Column="ModelKey"></ColumnReference></Identifier></ScalarOperator><ScalarOperator><Identifier><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[Product]" Alias="[P]" Column="ModelKey"></ColumnReference></Identifier></ScalarOperator></Compare></ScalarOperator></Residual><RelOp NodeId="4" PhysicalOp="Clustered Index Scan" LogicalOp="Clustered Index Scan" EstimateRows="136" EstimatedRowsRead="136" EstimateIO="0.00386574" EstimateCPU="0.0003066" AvgRowSize="23" EstimatedTotalSubtreeCost="0.00417234" TableCardinality="136" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductModel]" Alias="[PM]" Column="ModelKey"></ColumnReference><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductModel]" Alias="[PM]" Column="Color"></ColumnReference></OutputList><IndexScan Ordered="1" ScanDirection="FORWARD" ForcedIndex="0" ForceSeek="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductModel]" Alias="[PM]" Column="ModelKey"></ColumnReference></DefinedValue><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[ProductModel]" Alias="[PM]" Column="Color"></ColumnReference></DefinedValue></DefinedValues><Object Database="[AdventureWorks]" Schema="[Products]" Table="[ProductModel]" Index="[PK__ProductM__FB68A01A83174928]" Alias="[PM]" IndexKind="Clustered" Storage="RowStore"></Object></IndexScan></RelOp><RelOp NodeId="5" PhysicalOp="Sort" LogicalOp="Sort" EstimateRows="397" EstimateIO="0.0112613" EstimateCPU="0.0054466" AvgRowSize="11" EstimatedTotalSubtreeCost="0.047834" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[Product]" Alias="[P]" Column="ModelKey"></ColumnReference></OutputList><MemoryFractions Input="0.5" Output="0.5"></MemoryFractions><Sort Distinct="0"><OrderBy><OrderByColumn Ascending="1"><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[Product]" Alias="[P]" Column="ModelKey"></ColumnReference></OrderByColumn></OrderBy><RelOp NodeId="6" PhysicalOp="Clustered Index Scan" LogicalOp="Clustered Index Scan" EstimateRows="397" EstimatedRowsRead="397" EstimateIO="0.0305324" EstimateCPU="0.0005937" AvgRowSize="11" EstimatedTotalSubtreeCost="0.0311261" TableCardinality="397" Parallel="0" EstimateRebinds="0" EstimateRewinds="0" EstimatedExecutionMode="Row"><OutputList><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[Product]" Alias="[P]" Column="ModelKey"></ColumnReference></OutputList><IndexScan Ordered="0" ForcedIndex="0" ForceScan="0" NoExpandHint="0" Storage="RowStore"><DefinedValues><DefinedValue><ColumnReference Database="[AdventureWorks]" Schema="[Products]" Table="[Product]" Alias="[P]" Column="ModelKey"></ColumnReference></DefinedValue></DefinedValues><Object Database="[AdventureWorks]" Schema="[Products]" Table="[Product]" Index="[PK__Product__A15E99B36D34A312]" Alias="[P]" IndexKind="Clustered" Storage="RowStore"></Object></IndexScan></RelOp></Sort></RelOp></Merge></RelOp></Sort></RelOp></StreamAggregate></RelOp></ComputeScalar></RelOp></QueryPlan></StmtSimple></Statements></Batch></BatchSequence></ShowPlanXML>